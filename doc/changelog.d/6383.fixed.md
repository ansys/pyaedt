Refactoring of component_array creation