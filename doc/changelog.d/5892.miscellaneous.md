Improve API and security in Desktop