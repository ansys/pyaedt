
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Maxwell 3D: asymmetric conductor analysis &#8212; PyAEDT</title>
    
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css\ansys_sphinx_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    
        <link href="../../_static/css/breadcrumbs.css" rel="stylesheet">
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Maxwell 3D: choke setup" href="Maxwell3D_Choke.html" />
    <link rel="prev" title="Maxwell 3D: bath plate analysis" href="Maxwell3DTeam3.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/pyansys-logo-black-cropped.png" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/pyansys-logo-black-cropped.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../User_guide/index.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../API/index.html">
  AEDT API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../EDBAPI/index.html">
  EDB API
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Contributing.html">
  Contribute
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        0.6  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables examples/03-Maxwell/Maxwell3DTeam7 and {'json_url': 'https://aedt.docs.pyansys.com/release/versions.json', 'version_match': '0.6'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "examples/03-Maxwell/Maxwell3DTeam7.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://aedt.docs.pyansys.com/release/versions.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "examples/03-Maxwell/Maxwell3DTeam7.html";
        let btn = document.getElementById("version_switcher_button");
        // Set empty strings by default so that these attributes exist and can be used in CSS selectors
        btn.dataset["activeVersionName"] = "";
        btn.dataset["activeVersion"] = "";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.6.70 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "0.6") {
                node.classList.add("active");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/pyaedt" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/pyaedt/discussions" rel="noopener" target="_blank" title="Support"><span><i class="fa fa-comment fa-fw"></i></span>
            <label class="sr-only">Support</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    
     
<div id="announcement_msg"></div>
<script>
  fetch("announcement.html")
    .then((response) => {
      if (!response.ok) {
        throw new Error(`HTTP error: ${response.status}`);
      }
      return response.text();
    })
    .then(text => document.getElementById("announcement_msg").innerHTML = text)
    .catch((error) => console.error(`Fetch problem: ${error.message}`));
</script>

    
        <div class="container-xl">
    <div class="row">
        <div class="col-12 col-md-3" id="breadcrumbs-spacer"></div>
        <div class="col-12 col-md-11 col-xl-9" id="breadcrumbs">
          
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-additional-breadcrumb"><a href="https://docs.pyansys.com/">PyAnsys</a> » </li>
    
    
        <li class="nav-item nav-item-0"><a href="../../index.html">PyAEDT</a> » </li>
    

          <li class="nav-item nav-item-1"><a href="../index.html" >Examples</a> » </li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Maxwell examples</a> » </li>
        <li class="nav-item nav-item-this"><a href="">Maxwell 3D: asymmetric conductor analysis</a></li> 
      </ul>
    </div>
        </div>
  </div>
</div>
    


    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00-EDB/index.html">
   EDB examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-HFSS3DLayout/index.html">
   HFSS 3D Layout examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-Modeling-Setup/index.html">
   General model and setup examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-HFSS/index.html">
   HFSS examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-SBR%2B/index.html">
   SBR+ examples
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Maxwell examples
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Maxwell2D_Electrostatic.html">
     Maxwell 2D Electrostatic analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Maxwell2D_NissanLeaf.html">
     Maxwell 2D: PM synchronous motor transient analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Maxwell2D_Transient.html">
     Maxwell 2D: transient winding analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Maxwell3DTeam3.html">
     Maxwell 3D: bath plate analysis
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Maxwell 3D: asymmetric conductor analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Maxwell3D_Choke.html">
     Maxwell 3D: choke setup
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Maxwell_Magnet.html">
     Maxwell 3D: magnet DC analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04-Icepak/index.html">
   Icepak examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05-Q3D/index.html">
   2D Extractor and Q3D Extractor examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06-Multiphysics/index.html">
   Multiphysics examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-Circuit/index.html">
   Circuit examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-EMIT/index.html">
   EMIT examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-TwinBuilder/index.html">
   Twin Builder examples
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perform-required-imports">
   Perform required imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-non-graphical-mode">
   Set non-graphical mode
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#launch-aedt-and-maxwell-3d">
   Launch AEDT and Maxwell 3D
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-maxwell-3d-setup">
   Add Maxwell 3D setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-coil-dimensions">
   Define coil dimensions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-coordinate-system-for-positioning-coil">
   Create coordinate system for positioning coil
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-polyline">
   Create polyline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#duplicate-and-unite-polyline-to-create-full-coil">
   Duplicate and unite polyline to create full coil
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assign-material-and-if-solution-is-allowed-inside-coil">
   Assign material and if solution is allowed inside coil
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-terminal">
   Create terminal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-a-material">
   Add a material
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-aluminium-plate-with-a-hole">
   Model aluminium plate with a hole
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#draw-a-background-region">
   Draw a background region
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adjust-eddy-effects-for-plate-and-coil">
   Adjust eddy effects for plate and coil
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-expression-for-z-component-of-b-in-gauss">
   Create expression for Z component of B in Gauss
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#draw-two-lines-along-which-to-plot-bz">
   Draw two lines along which to plot Bz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-model">
   Plot model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-plots-of-induced-current-and-flux-density-on-surface-of-plate">
   Create plots of induced current and flux density on surface of plate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-project-and-solve">
   Save project and solve
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#release-aedt-from-pyaedt-scripting">
   Release AEDT from PyAEDT scripting
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      

<div class="tocsection editthispage">
    <a href="https://github.com/pyansys/pyaedt/edit/main/doc/source/examples/03-Maxwell/Maxwell3DTeam7.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-03-maxwell-maxwell3dteam7-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="maxwell-3d-asymmetric-conductor-analysis">
<span id="sphx-glr-examples-03-maxwell-maxwell3dteam7-py"></span><h1>Maxwell 3D: asymmetric conductor analysis<a class="headerlink" href="#maxwell-3d-asymmetric-conductor-analysis" title="Permalink to this heading">#</a></h1>
<p>This example uses PyAEDT to set up the TEAM 7 problem for an asymetric
conductor with a hole and solve it using the Maxwell 3D Eddy Current solver.</p>
<section id="perform-required-imports">
<h2>Perform required imports<a class="headerlink" href="#perform-required-imports" title="Permalink to this heading">#</a></h2>
<p>Perform required imports.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">Maxwell3d</span>
<span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">generate_unique_project_name</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</section>
<section id="set-non-graphical-mode">
<h2>Set non-graphical mode<a class="headerlink" href="#set-non-graphical-mode" title="Permalink to this heading">#</a></h2>
<p>Set non-graphical mode. <code class="docutils literal notranslate"><span class="pre">&quot;PYAEDT_NON_GRAPHICAL&quot;</span></code> is needed to generate
documentation only.
You can set <code class="docutils literal notranslate"><span class="pre">non_graphical</span></code> either to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/dev/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">non_graphical</span></a> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</section>
<section id="launch-aedt-and-maxwell-3d">
<h2>Launch AEDT and Maxwell 3D<a class="headerlink" href="#launch-aedt-and-maxwell-3d" title="Permalink to this heading">#</a></h2>
<p>Launch AEDT and Maxwell 3D. The following code sets up the project and design names, the solver, and
the version. It also creates an instance of the <code class="docutils literal notranslate"><span class="pre">Maxwell3d</span></code> class named <code class="docutils literal notranslate"><span class="pre">M3D</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Project_Name</span></a> <span class="o">=</span> <span class="s2">&quot;COMPUMAG&quot;</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Design_Name</span></a> <span class="o">=</span> <span class="s2">&quot;TEAM 7 Asymmetric Conductor&quot;</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Solver</span></a> <span class="o">=</span> <span class="s2">&quot;EddyCurrent&quot;</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">DesktopVersion</span></a> <span class="o">=</span> <span class="s2">&quot;2023.1&quot;</span>

<span class="n">M3D</span> <span class="o">=</span> <span class="n">Maxwell3d</span><span class="p">(</span>
    <span class="n">projectname</span><span class="o">=</span><span class="n">generate_unique_project_name</span><span class="p">(),</span>
    <span class="n">designname</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Design_Name</span></a><span class="p">,</span>
    <span class="n">solution_type</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Solver</span></a><span class="p">,</span>
    <span class="n">specified_version</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">DesktopVersion</span></a><span class="p">,</span>
    <a href="https://docs.python.org/dev/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">non_graphical</span></a><span class="o">=</span><a href="https://docs.python.org/dev/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">non_graphical</span></a><span class="p">,</span>
    <span class="n">new_desktop_session</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">model_units</span> <span class="o">=</span> <span class="s2">&quot;mm&quot;</span>
<span class="n">modeler</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span>
<span class="n">Plot</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">GetModule</span><span class="p">(</span><span class="s2">&quot;ReportSetup&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\actions-runner\_work\_tool\Python\3.8.10\x64\lib\subprocess.py:946: ResourceWarning: subprocess 2244 is still running
  _warn(&quot;subprocess %s is still running&quot; % self.pid,
c:\actions-runner\_work\pyaedt\pyaedt\testenv\lib\site-packages\pyaedt\desktop.py:79: ResourceWarning: unclosed file &lt;_io.BufferedReader name=11&gt;
  subprocess.Popen(&quot; &quot;.join(command), env=my_env, stdout=subprocess.DEVNULL, stderr=subprocess.PIPE)
c:\actions-runner\_work\pyaedt\pyaedt\testenv\lib\site-packages\pyaedt\desktop.py:86: ResourceWarning: unclosed &lt;socket.socket fd=8632, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=(&#39;0.0.0.0&#39;, 53978)&gt;
  while not _check_grpc_port(port):
c:\actions-runner\_work\pyaedt\pyaedt\testenv\lib\site-packages\pyaedt\desktop.py:86: ResourceWarning: unclosed &lt;socket.socket fd=7816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=(&#39;0.0.0.0&#39;, 53984)&gt;
  while not _check_grpc_port(port):
c:\actions-runner\_work\pyaedt\pyaedt\testenv\lib\site-packages\pyaedt\desktop.py:86: ResourceWarning: unclosed &lt;socket.socket fd=8276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=(&#39;0.0.0.0&#39;, 53989)&gt;
  while not _check_grpc_port(port):
c:\actions-runner\_work\pyaedt\pyaedt\testenv\lib\site-packages\pyaedt\desktop.py:86: ResourceWarning: unclosed &lt;socket.socket fd=8276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=(&#39;0.0.0.0&#39;, 53992)&gt;
  while not _check_grpc_port(port):
</pre></div>
</div>
</section>
<section id="add-maxwell-3d-setup">
<h2>Add Maxwell 3D setup<a class="headerlink" href="#add-maxwell-3d-setup" title="Permalink to this heading">#</a></h2>
<p>Add a Maxwell 3D setup with frequency points at DC, 50 Hz, and 200Hz.
Otherwise, the default PyAEDT setup values are used. To approximate a DC field in the
Eddy Current solver, use a low frequency value. Second-order shape functions improve
the smoothness of the induced currents in the plate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_freq</span></a> <span class="o">=</span> <span class="mf">0.1</span>
<a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stop_freq</span></a> <span class="o">=</span> <span class="mi">50</span>

<span class="n">Setup</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">create_setup</span><span class="p">(</span><span class="n">setupname</span><span class="o">=</span><span class="s2">&quot;Setup1&quot;</span><span class="p">)</span>
<span class="n">Setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;200Hz&quot;</span>
<span class="n">Setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;HasSweepSetup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">Setup</span><span class="o">.</span><span class="n">add_eddy_current_sweep</span><span class="p">(</span><span class="s2">&quot;LinearStep&quot;</span><span class="p">,</span> <a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_freq</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stop_freq</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stop_freq</span></a> <span class="o">-</span> <a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_freq</span></a><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseHighOrderShapeFunc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">Setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;PercentError&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span>
</pre></div>
</div>
</section>
<section id="define-coil-dimensions">
<h2>Define coil dimensions<a class="headerlink" href="#define-coil-dimensions" title="Permalink to this heading">#</a></h2>
<p>Define coil dimensions as shown on the TEAM7 drawing of the coil.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_external</span></a> <span class="o">=</span> <span class="mi">150</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">+</span> <span class="mi">25</span>
<a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_internal</span></a> <span class="o">=</span> <span class="mi">150</span>
<a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r1</span></a> <span class="o">=</span> <span class="mi">25</span>
<a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r2</span></a> <span class="o">=</span> <span class="mi">50</span>
<a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_thk</span></a> <span class="o">=</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r2</span></a> <span class="o">-</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r1</span></a>
<a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_height</span></a> <span class="o">=</span> <span class="mi">100</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_centre</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">294</span> <span class="o">-</span> <span class="mi">25</span> <span class="o">-</span> <span class="mi">150</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">25</span> <span class="o">+</span> <span class="mi">150</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">19</span> <span class="o">+</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>

<span class="c1"># Use expressions to construct the three dimensions needed to describe the midpoints of</span>
<span class="c1"># the coil.</span>

<a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim1</span></a> <span class="o">=</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_internal</span></a> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_external</span></a> <span class="o">-</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_internal</span></a><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
<a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim2</span></a> <span class="o">=</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_internal</span></a> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r1</span></a>
<a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">dim3</span></a> <span class="o">=</span> <a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim2</span></a> <span class="o">+</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(((</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r1</span></a> <span class="o">+</span> <span class="p">(</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r2</span></a> <span class="o">-</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_r1</span></a><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Use coordinates to draw a polyline along which to sweep the coil cross sections.</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P1</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim1</span></a><span class="p">,</span> <span class="o">-</span><a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim2</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P2</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim1</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim2</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P3</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">dim3</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">dim3</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P4</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim2</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dim1</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="create-coordinate-system-for-positioning-coil">
<h2>Create coordinate system for positioning coil<a class="headerlink" href="#create-coordinate-system-for-positioning-coil" title="Permalink to this heading">#</a></h2>
<p>Create a coordinate system for positioning the coil.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_coordinate_system</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_centre</span></a><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;view&quot;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s2">&quot;XY&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Coil_CS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyaedt.modeler.cad.Modeler.CoordinateSystem object at 0x00000228A94D0610&gt;
</pre></div>
</div>
</section>
<section id="create-polyline">
<h2>Create polyline<a class="headerlink" href="#create-polyline" title="Permalink to this heading">#</a></h2>
<p>Create a polyline. One quarter of the coil is modeled by sweeping a 2D sheet along a polyline.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_polyline</span><span class="p">(</span><span class="n">position_list</span><span class="o">=</span><span class="p">[</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P1</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P2</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P3</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P4</span></a><span class="p">],</span> <span class="n">segment_type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Line&quot;</span><span class="p">,</span> <span class="s2">&quot;Arc&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Coil&quot;</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">set_crosssection_properties</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Rectangle&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_thk</span></a><span class="p">,</span> <span class="n">height</span><span class="o">=</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_height</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyaedt.modeler.cad.polylines.Polyline object at 0x00000228A94D0760&gt;
</pre></div>
</div>
</section>
<section id="duplicate-and-unite-polyline-to-create-full-coil">
<h2>Duplicate and unite polyline to create full coil<a class="headerlink" href="#duplicate-and-unite-polyline-to-create-full-coil" title="Permalink to this heading">#</a></h2>
<p>Duplicate and unit the polyline to create a full coil.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">duplicate_around_axis</span><span class="p">(</span>
    <span class="s2">&quot;Coil&quot;</span><span class="p">,</span> <span class="n">cs_axis</span><span class="o">=</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">nclones</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">create_new_objects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_3d_comp</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">unite</span><span class="p">(</span><span class="s2">&quot;Coil,Coil_1,Coil_2&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">unite</span><span class="p">(</span><span class="s2">&quot;Coil,Coil_3&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">fit_all</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="assign-material-and-if-solution-is-allowed-inside-coil">
<h2>Assign material and if solution is allowed inside coil<a class="headerlink" href="#assign-material-and-if-solution-is-allowed-inside-coil" title="Permalink to this heading">#</a></h2>
<p>Assign the material <code class="docutils literal notranslate"><span class="pre">Cooper</span></code> from the Maxwell internal library to the coil and
allow a solution inside the coil.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">assign_material</span><span class="p">(</span><span class="s2">&quot;Coil&quot;</span><span class="p">,</span> <span class="s2">&quot;Copper&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">solve_inside</span><span class="p">(</span><span class="s2">&quot;Coil&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</section>
<section id="create-terminal">
<h2>Create terminal<a class="headerlink" href="#create-terminal" title="Permalink to this heading">#</a></h2>
<p>Create a terminal for the coil from a cross section that is split and one half deleted.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">section</span><span class="p">(</span><span class="s2">&quot;Coil&quot;</span><span class="p">,</span> <span class="s2">&quot;YZ&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">separate_bodies</span><span class="p">(</span><span class="s2">&quot;Coil_Section1&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;Coil_Section1_Separate1&quot;</span><span class="p">)</span>

<span class="c1"># Add variable for coil excitation</span>
<span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="c1"># Add a design variable for coil excitation. The NB units here are AmpereTurns.</span>

<a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Coil_Excitation</span></a> <span class="o">=</span> <span class="mi">2742</span>
<span class="n">M3D</span><span class="p">[</span><span class="s2">&quot;Coil_Excitation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Coil_Excitation</span></a><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;A&quot;</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">assign_current</span><span class="p">(</span><span class="s2">&quot;Coil_Section1&quot;</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="s2">&quot;Coil_Excitation&quot;</span><span class="p">,</span> <span class="n">solid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">set_working_coordinate_system</span><span class="p">(</span><span class="s2">&quot;Global&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</section>
<section id="add-a-material">
<h2>Add a material<a class="headerlink" href="#add-a-material" title="Permalink to this heading">#</a></h2>
<p>Add a material named <code class="docutils literal notranslate"><span class="pre">team3_aluminium</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">add_material</span><span class="p">(</span><span class="s2">&quot;team7_aluminium&quot;</span><span class="p">)</span>
<span class="n">mat</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="mf">3.526e7</span>
</pre></div>
</div>
</section>
<section id="model-aluminium-plate-with-a-hole">
<h2>Model aluminium plate with a hole<a class="headerlink" href="#model-aluminium-plate-with-a-hole" title="Permalink to this heading">#</a></h2>
<p>Model the aluminium plate with a hole by subtracting two rectangular cuboids.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plate</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_box</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dimensions_list</span><span class="o">=</span><span class="p">[</span><span class="mi">294</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span>
                               <span class="n">matname</span><span class="o">=</span><span class="s2">&quot;team7_aluminium&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">fit_all</span><span class="p">()</span>
<span class="n">hole</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_box</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dimensions_list</span><span class="o">=</span><span class="p">[</span><span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hole&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Hole&quot;</span><span class="p">],</span> <span class="n">keep_originals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</section>
<section id="draw-a-background-region">
<h2>Draw a background region<a class="headerlink" href="#draw-a-background-region" title="Permalink to this heading">#</a></h2>
<p>Draw a background region that uses the default properties for an air region.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_air_region</span><span class="p">(</span><span class="n">x_pos</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">x_neg</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_neg</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">z_neg</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyaedt.modeler.cad.object3d.Object3d object at 0x00000228A8EF2DC0&gt;
</pre></div>
</div>
</section>
<section id="adjust-eddy-effects-for-plate-and-coil">
<h2>Adjust eddy effects for plate and coil<a class="headerlink" href="#adjust-eddy-effects-for-plate-and-coil" title="Permalink to this heading">#</a></h2>
<p>Adjust the eddy effects for the plate and coil by turning off displacement currents
for all parts. The setting for eddy effect is ignored for the stranded conductor type
used in the coil.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">eddy_effects_on</span><span class="p">(</span><span class="n">object_list</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">eddy_effects_on</span><span class="p">(</span><span class="n">object_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Coil&quot;</span><span class="p">,</span> <span class="s2">&quot;Region&quot;</span><span class="p">,</span> <span class="s2">&quot;Line_A1_B1mesh&quot;</span><span class="p">,</span> <span class="s2">&quot;Line_A2_B2mesh&quot;</span><span class="p">],</span>
                    <span class="n">activate_eddy_effects</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">activate_displacement_current</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</section>
<section id="create-expression-for-z-component-of-b-in-gauss">
<h2>Create expression for Z component of B in Gauss<a class="headerlink" href="#create-expression-for-z-component-of-b-in-gauss" title="Permalink to this heading">#</a></h2>
<p>Create an expression for the Z component of B in Gauss using the fields calculator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fields</span> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">GetModule</span><span class="p">(</span><span class="s2">&quot;FieldsReporter&quot;</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">EnterQty</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">CalcOp</span><span class="p">(</span><span class="s2">&quot;ScalarZ&quot;</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">EnterScalarFunc</span><span class="p">(</span><span class="s2">&quot;Phase&quot;</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">CalcOp</span><span class="p">(</span><span class="s2">&quot;AtPhase&quot;</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">EnterScalar</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">CalcOp</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">CalcOp</span><span class="p">(</span><span class="s2">&quot;Smooth&quot;</span><span class="p">)</span>
<span class="n">Fields</span><span class="o">.</span><span class="n">AddNamedExpression</span><span class="p">(</span><span class="s2">&quot;Bz&quot;</span><span class="p">,</span> <span class="s2">&quot;Fields&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="draw-two-lines-along-which-to-plot-bz">
<h2>Draw two lines along which to plot Bz<a class="headerlink" href="#draw-two-lines-along-which-to-plot-bz" title="Permalink to this heading">#</a></h2>
<p>Draw two lines along which to plot Bz. The following code also adds a small cylinder
to refine the mesh locally around each line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Line_A1_B1&quot;</span><span class="p">,</span> <span class="s2">&quot;Line_A2_B2&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh_diameter</span></a> <span class="o">=</span> <span class="s2">&quot;2mm&quot;</span>

<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_points_1</span></a> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0mm&quot;</span><span class="p">,</span> <span class="s2">&quot;72mm&quot;</span><span class="p">,</span> <span class="s2">&quot;34mm&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;288mm&quot;</span><span class="p">,</span> <span class="s2">&quot;72mm&quot;</span><span class="p">,</span> <span class="s2">&quot;34mm&quot;</span><span class="p">]]</span>
<span class="n">polyline</span> <span class="o">=</span> <span class="n">modeler</span><span class="o">.</span><span class="n">create_polyline</span><span class="p">(</span><span class="n">position_list</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_points_1</span></a><span class="p">,</span> <span class="n">name</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">L1Mesh</span> <span class="o">=</span> <span class="n">modeler</span><span class="o">.</span><span class="n">create_polyline</span><span class="p">(</span><span class="n">position_list</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_points_1</span></a><span class="p">,</span> <span class="n">name</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;mesh&quot;</span><span class="p">)</span>
<span class="n">L1Mesh</span><span class="o">.</span><span class="n">set_crosssection_properties</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Circle&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh_diameter</span></a><span class="p">)</span>

<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_points_2</span></a> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0mm&quot;</span><span class="p">,</span> <span class="s2">&quot;144mm&quot;</span><span class="p">,</span> <span class="s2">&quot;34mm&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;288mm&quot;</span><span class="p">,</span> <span class="s2">&quot;144mm&quot;</span><span class="p">,</span> <span class="s2">&quot;34mm&quot;</span><span class="p">]]</span>
<span class="n">polyline2</span> <span class="o">=</span> <span class="n">modeler</span><span class="o">.</span><span class="n">create_polyline</span><span class="p">(</span><span class="n">position_list</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_points_2</span></a><span class="p">,</span> <span class="n">name</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">polyline2_mesh</span> <span class="o">=</span> <span class="n">modeler</span><span class="o">.</span><span class="n">create_polyline</span><span class="p">(</span><span class="n">position_list</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_points_2</span></a><span class="p">,</span> <span class="n">name</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;mesh&quot;</span><span class="p">)</span>
<span class="n">polyline2_mesh</span><span class="o">.</span><span class="n">set_crosssection_properties</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Circle&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh_diameter</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyaedt.modeler.cad.polylines.Polyline object at 0x00000228A8EE8BE0&gt;
</pre></div>
</div>
</section>
<section id="plot-model">
<h2>Plot model<a class="headerlink" href="#plot-model" title="Permalink to this heading">#</a></h2>
<p>Plot the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">export_path</span><span class="o">=</span><a href="https://docs.python.org/dev/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><span class="n">M3D</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s2">&quot;Image.jpg&quot;</span><span class="p">),</span> <span class="n">plot_air_objects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Maxwell3DTeam7_001.png" srcset="../../_images/sphx_glr_Maxwell3DTeam7_001.png" alt="Maxwell3DTeam7" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyaedt.generic.plot.ModelPlotter object at 0x00000228AA4B5160&gt;
</pre></div>
</div>
<p>Published measurement results are included with this script via the list below.
Test results are used to create text files for import into a rectangular plot
and to overlay simulation results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_dir</span></a> <span class="o">=</span> <span class="n">M3D</span><span class="o">.</span><span class="n">working_directory</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Bz A1_B1 000 0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A1_B1 050 0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A1_B1 050 90&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A1_B1 200 0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A1_B1 200 90&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A2_B2 050 0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A2_B2 050 90&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A2_B2 200 0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bz A2_B2 200 90&quot;</span><span class="p">,</span>
<span class="p">]</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Distance [mm]&quot;</span><span class="p">,</span> <span class="s2">&quot;Bz [Tesla]&quot;</span><span class="p">]</span>

<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_length</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">288</span><span class="p">]</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="o">-</span><span class="mf">6.667</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.764</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.707</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.812</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.870</span><span class="p">,</span>
        <span class="mf">8.713</span><span class="p">,</span>
        <span class="mf">50.40</span><span class="p">,</span>
        <span class="mf">88.47</span><span class="p">,</span>
        <span class="mf">100.9</span><span class="p">,</span>
        <span class="mf">104.0</span><span class="p">,</span>
        <span class="mf">104.8</span><span class="p">,</span>
        <span class="mf">104.9</span><span class="p">,</span>
        <span class="mf">104.6</span><span class="p">,</span>
        <span class="mf">103.1</span><span class="p">,</span>
        <span class="mf">97.32</span><span class="p">,</span>
        <span class="mf">75.19</span><span class="p">,</span>
        <span class="mf">29.04</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">4.90</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">17.88</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">22.13</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">20.19</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">15.67</span><span class="p">,</span>
        <span class="mf">0.36</span><span class="p">,</span>
        <span class="mf">43.64</span><span class="p">,</span>
        <span class="mf">78.11</span><span class="p">,</span>
        <span class="mf">71.55</span><span class="p">,</span>
        <span class="mf">60.44</span><span class="p">,</span>
        <span class="mf">53.91</span><span class="p">,</span>
        <span class="mf">52.62</span><span class="p">,</span>
        <span class="mf">53.81</span><span class="p">,</span>
        <span class="mf">56.91</span><span class="p">,</span>
        <span class="mf">59.24</span><span class="p">,</span>
        <span class="mf">52.78</span><span class="p">,</span>
        <span class="mf">27.61</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.16</span><span class="p">,</span> <span class="mf">2.84</span><span class="p">,</span> <span class="mf">4.15</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">3.07</span><span class="p">,</span> <span class="mf">2.31</span><span class="p">,</span> <span class="mf">1.89</span><span class="p">,</span> <span class="mf">4.97</span><span class="p">,</span> <span class="mf">12.61</span><span class="p">,</span> <span class="mf">14.15</span><span class="p">,</span> <span class="mf">13.04</span><span class="p">,</span> <span class="mf">12.40</span><span class="p">,</span> <span class="mf">12.05</span><span class="p">,</span> <span class="mf">12.27</span><span class="p">,</span> <span class="mf">12.66</span><span class="p">,</span> <span class="mf">9.96</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">],</span>
    <span class="p">[</span>
        <span class="o">-</span><span class="mf">3.63</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">18.46</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">23.62</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">21.59</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">16.09</span><span class="p">,</span>
        <span class="mf">0.23</span><span class="p">,</span>
        <span class="mf">44.35</span><span class="p">,</span>
        <span class="mf">75.53</span><span class="p">,</span>
        <span class="mf">63.42</span><span class="p">,</span>
        <span class="mf">53.20</span><span class="p">,</span>
        <span class="mf">48.66</span><span class="p">,</span>
        <span class="mf">47.31</span><span class="p">,</span>
        <span class="mf">48.31</span><span class="p">,</span>
        <span class="mf">51.26</span><span class="p">,</span>
        <span class="mf">53.61</span><span class="p">,</span>
        <span class="mf">46.11</span><span class="p">,</span>
        <span class="mf">24.96</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.38</span><span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">2.15</span><span class="p">,</span> <span class="mf">1.63</span><span class="p">,</span> <span class="mf">1.10</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.40</span><span class="p">,</span> <span class="mf">4.17</span><span class="p">,</span> <span class="mf">3.94</span><span class="p">,</span> <span class="mf">4.86</span><span class="p">,</span> <span class="mf">4.09</span><span class="p">,</span> <span class="mf">3.69</span><span class="p">,</span> <span class="mf">4.60</span><span class="p">,</span> <span class="mf">3.48</span><span class="p">,</span> <span class="mf">4.10</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">],</span>
    <span class="p">[</span>
        <span class="o">-</span><span class="mf">1.83</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.50</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">13.60</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">15.21</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">14.48</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.62</span><span class="p">,</span>
        <span class="mf">28.77</span><span class="p">,</span>
        <span class="mf">60.34</span><span class="p">,</span>
        <span class="mf">61.84</span><span class="p">,</span>
        <span class="mf">56.64</span><span class="p">,</span>
        <span class="mf">53.40</span><span class="p">,</span>
        <span class="mf">52.36</span><span class="p">,</span>
        <span class="mf">53.93</span><span class="p">,</span>
        <span class="mf">56.82</span><span class="p">,</span>
        <span class="mf">59.48</span><span class="p">,</span>
        <span class="mf">52.08</span><span class="p">,</span>
        <span class="mf">26.56</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">3.40</span><span class="p">,</span> <span class="mf">6.53</span><span class="p">,</span> <span class="mf">10.25</span><span class="p">,</span> <span class="mf">11.83</span><span class="p">,</span> <span class="mf">11.83</span><span class="p">,</span> <span class="mf">11.01</span><span class="p">,</span> <span class="mf">10.58</span><span class="p">,</span> <span class="mf">10.80</span><span class="p">,</span> <span class="mf">10.54</span><span class="p">,</span> <span class="mf">10.62</span><span class="p">,</span> <span class="mf">9.03</span><span class="p">,</span> <span class="mf">1.79</span><span class="p">],</span>
    <span class="p">[</span>
        <span class="o">-</span><span class="mf">0.86</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">11.58</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">13.36</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">13.77</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.74</span><span class="p">,</span>
        <span class="mf">24.63</span><span class="p">,</span>
        <span class="mf">53.19</span><span class="p">,</span>
        <span class="mf">54.89</span><span class="p">,</span>
        <span class="mf">50.72</span><span class="p">,</span>
        <span class="mf">48.03</span><span class="p">,</span>
        <span class="mf">47.13</span><span class="p">,</span>
        <span class="mf">48.25</span><span class="p">,</span>
        <span class="mf">51.35</span><span class="p">,</span>
        <span class="mf">53.35</span><span class="p">,</span>
        <span class="mf">45.37</span><span class="p">,</span>
        <span class="mf">24.01</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">1.39</span><span class="p">,</span> <span class="mf">2.67</span><span class="p">,</span> <span class="mf">3.00</span><span class="p">,</span> <span class="mf">4.01</span><span class="p">,</span> <span class="mf">3.80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">3.02</span><span class="p">,</span> <span class="mf">2.20</span><span class="p">,</span> <span class="mf">2.78</span><span class="p">,</span> <span class="mf">1.58</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">],</span>
<span class="p">]</span>

<span class="c1"># Dataset details are used to encode test parameters in the text files.</span>
<span class="c1"># For example, ``Bz A1_B1 050 0`` is the Z component of flux density ``B``</span>
<span class="c1"># along line ``A1_B1`` at 50 Hz and 0 deg. These text files are created</span>
<span class="c1"># and saved in the default project directory.</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;project_dir&quot;</span><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_dir</span></a><span class="p">)</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#range" title="builtins.range" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_range</span></a> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#range" title="builtins.range" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_length_range</span></a> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_length</span></a><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_list</span></a> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a> <span class="ow">in</span> <a href="https://docs.python.org/dev/library/stdtypes.html#range" title="builtins.range" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_range</span></a><span class="p">:</span>
    <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_list</span></a><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">for</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">jtem</span></a> <span class="ow">in</span> <a href="https://docs.python.org/dev/library/stdtypes.html#range" title="builtins.range" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_length_range</span></a><span class="p">:</span>
        <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_list</span></a><span class="o">.</span><span class="n">insert</span><span class="p">(</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">jtem</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">jtem</span></a><span class="p">])</span>
        <a href="https://docs.python.org/dev/library/functions.html#zip" title="builtins.zip" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-function"><span class="n">ziplist</span></a> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line_length</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_list</span></a><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_dir</span></a> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <a href="https://docs.python.org/dev/library/io.html#io.TextIOWrapper" title="io.TextIOWrapper" class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <a href="https://docs.python.org/dev/library/csv.html#csv.writer" title="csv.writer" class="sphx-glr-backref-module-csv sphx-glr-backref-type-py-function"><span class="n">csv</span><span class="o">.</span><span class="n">writer</span></a><span class="p">(</span><a href="https://docs.python.org/dev/library/io.html#io.TextIOWrapper" title="io.TextIOWrapper" class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header</span></a><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><a href="https://docs.python.org/dev/library/functions.html#zip" title="builtins.zip" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-function"><span class="n">ziplist</span></a><span class="p">)</span>

<span class="c1"># Create rectangular plots</span>
<span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="c1"># Create rectangular plots, using text file encoding to control their formatting. Create</span>
<span class="c1"># the DC plot separately because it needs a different frequency and phase than the other plots.</span>

<span class="k">for</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a> <span class="ow">in</span> <a href="https://docs.python.org/dev/library/stdtypes.html#range" title="builtins.range" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_range</span></a><span class="p">:</span>
    <span class="k">if</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a> <span class="o">=</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;Along the Line&quot;</span> <span class="o">+</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;Hz&quot;</span>
        <span class="k">if</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;000&quot;</span><span class="p">:</span>
            <a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variations</span></a> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;Distance&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">],</span>
                <span class="s2">&quot;Freq&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/dev/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_freq</span></a><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span>
                <span class="s2">&quot;Phase&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0deg&quot;</span><span class="p">],</span>
                <span class="s2">&quot;Coil_Excitation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">],</span>
            <span class="p">}</span>
            <span class="n">M3D</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
                <a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a><span class="p">,</span>
                <span class="n">report_category</span><span class="o">=</span><span class="s2">&quot;Fields&quot;</span><span class="p">,</span>
                <span class="n">context</span><span class="o">=</span><span class="s2">&quot;Line_&quot;</span> <span class="o">+</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span>
                <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span>
                <a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variations</span></a><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variations</span></a><span class="p">,</span>
                <span class="n">expressions</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variations</span></a> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;Distance&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">],</span>
                <span class="s2">&quot;Freq&quot;</span><span class="p">:</span> <span class="p">[</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span>
                <span class="s2">&quot;Phase&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0deg&quot;</span><span class="p">,</span> <span class="s2">&quot;90deg&quot;</span><span class="p">],</span>
                <span class="s2">&quot;Coil_Excitation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">],</span>
            <span class="p">}</span>
            <span class="n">M3D</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
                <a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a><span class="p">,</span>
                <span class="n">report_category</span><span class="o">=</span><span class="s2">&quot;Fields&quot;</span><span class="p">,</span>
                <span class="n">context</span><span class="o">=</span><span class="s2">&quot;Line_&quot;</span> <span class="o">+</span> <a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span>
                <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span>
                <a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variations</span></a><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variations</span></a><span class="p">,</span>
                <span class="n">expressions</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">)</span>

<span class="c1"># Import test data into correct plot and overlay with simulation results</span>
<span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="c1"># Import test data into the correct plot and overlay it with the simulation results.</span>

<span class="k">if</span> <a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">Plot</span><span class="o">.</span><span class="n">ImportIntoReport</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_dir</span></a><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">Plot</span><span class="o">.</span><span class="n">ImportIntoReport</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_dir</span></a> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span><span class="p">)</span>
    <span class="n">Plot</span><span class="o">.</span><span class="n">ImportIntoReport</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotname</span></a><span class="p">,</span> <a href="https://docs.python.org/dev/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_dir</span></a> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">[</span><a href="https://docs.python.org/dev/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">item</span></a><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>project_dir D:/Temp/pyaedt_prj_POV/Project_3IF.pyaedt\TEAM_7_Asymmetric_Conductor
</pre></div>
</div>
</section>
<section id="create-plots-of-induced-current-and-flux-density-on-surface-of-plate">
<h2>Create plots of induced current and flux density on surface of plate<a class="headerlink" href="#create-plots-of-induced-current-and-flux-density-on-surface-of-plate" title="Permalink to this heading">#</a></h2>
<p>Create two plots of the induced current (<code class="docutils literal notranslate"><span class="pre">Mag_J</span></code>) and the flux density (<code class="docutils literal notranslate"><span class="pre">Mag_B</span></code>) on the
surface of the plate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surflist</span></a> <span class="o">=</span> <span class="n">modeler</span><span class="o">.</span><span class="n">get_object_faces</span><span class="p">(</span><span class="s2">&quot;Plate&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">intrinsic_dict</span></a> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Freq&quot;</span><span class="p">:</span> <span class="s2">&quot;200Hz&quot;</span><span class="p">,</span> <span class="s2">&quot;Phase&quot;</span><span class="p">:</span> <span class="s2">&quot;0deg&quot;</span><span class="p">}</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_fieldplot_surface</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surflist</span></a><span class="p">,</span> <span class="s2">&quot;Mag_J&quot;</span><span class="p">,</span> <span class="n">intrinsincDict</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">intrinsic_dict</span></a><span class="p">,</span> <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Mag_J&quot;</span><span class="p">)</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_fieldplot_surface</span><span class="p">(</span><a href="https://docs.python.org/dev/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surflist</span></a><span class="p">,</span> <span class="s2">&quot;Mag_B&quot;</span><span class="p">,</span> <span class="n">intrinsincDict</span><span class="o">=</span><a href="https://docs.python.org/dev/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">intrinsic_dict</span></a><span class="p">,</span> <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Mag_B&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyaedt.modules.solutions.FieldPlot object at 0x00000228A96882E0&gt;
</pre></div>
</div>
</section>
<section id="save-project-and-solve">
<h2>Save project and solve<a class="headerlink" href="#save-project-and-solve" title="Permalink to this heading">#</a></h2>
<p>Save the project and solve it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">save_project</span><span class="p">()</span>
<span class="n">M3D</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</section>
<section id="release-aedt-from-pyaedt-scripting">
<h2>Release AEDT from PyAEDT scripting<a class="headerlink" href="#release-aedt-from-pyaedt-scripting" title="Permalink to this heading">#</a></h2>
<p>Release AEDT from PyAEDT scripting. If you wanted to leave AEDT and the project open
after running the above script, in the following command, you would set <code class="docutils literal notranslate"><span class="pre">(False,</span> <span class="pre">False)</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M3D</span><span class="o">.</span><span class="n">release_desktop</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 6 minutes  56.492 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-03-maxwell-maxwell3dteam7-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8b986a64b6ba596a3c13633bd7ddcc1c/Maxwell3DTeam7.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">Maxwell3DTeam7.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/bff82223783d88e82227125fba51f23c/Maxwell3DTeam7.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">Maxwell3DTeam7.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright (c) 2023 ANSYS, Inc. All rights reserved.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>