
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyaedt.modeler.geometry_operators &#8212; PyAEDT</title>
    
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css\ansys_sphinx_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    
        <link href="../../../_static/css/breadcrumbs.css" rel="stylesheet">
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
    <img src="../../../_static/pyansys-logo-black-cropped.png" class="logo__image only-light" alt="Logo image">
    <img src="../../../_static/pyansys-logo-black-cropped.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../Getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../User_guide/index.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../API/index.html">
  AEDT API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../EDBAPI/index.html">
  EDB API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../Contributing.html">
  Contribute
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        0.6  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables _modules/pyaedt/modeler/geometry_operators and {'json_url': 'https://aedt.docs.pyansys.com/release/versions.json', 'version_match': '0.6'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "_modules/pyaedt/modeler/geometry_operators.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://aedt.docs.pyansys.com/release/versions.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "_modules/pyaedt/modeler/geometry_operators.html";
        let btn = document.getElementById("version_switcher_button");
        // Set empty strings by default so that these attributes exist and can be used in CSS selectors
        btn.dataset["activeVersionName"] = "";
        btn.dataset["activeVersion"] = "";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.6.70 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "0.6") {
                node.classList.add("active");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/pyaedt" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/pyaedt/discussions" rel="noopener" target="_blank" title="Support"><span><i class="fa fa-comment fa-fw"></i></span>
            <label class="sr-only">Support</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    
     
<div id="announcement_msg"></div>
<script>
  fetch("announcement.html")
    .then((response) => {
      if (!response.ok) {
        throw new Error(`HTTP error: ${response.status}`);
      }
      return response.text();
    })
    .then(text => document.getElementById("announcement_msg").innerHTML = text)
    .catch((error) => console.error(`Fetch problem: ${error.message}`));
</script>

    
        <div class="container-xl">
    <div class="row">
        <div class="col-12 col-md-3" id="breadcrumbs-spacer"></div>
        <div class="col-12 col-md-11 col-xl-9" id="breadcrumbs">
          
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-additional-breadcrumb"><a href="https://docs.pyansys.com/">PyAnsys</a> » </li>
    
    
        <li class="nav-item nav-item-0"><a href="../../../index.html">PyAEDT</a> » </li>
    

          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> » </li>
        <li class="nav-item nav-item-this"><a href="">pyaedt.modeler.geometry_operators</a></li> 
      </ul>
    </div>
        </div>
  </div>
</div>
    


    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <h1>Source code for pyaedt.modeler.geometry_operators</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">pyaedt.generic.constants</span> <span class="kn">import</span> <span class="n">AXIS</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.constants</span> <span class="kn">import</span> <span class="n">PLANE</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.constants</span> <span class="kn">import</span> <span class="n">SWEEPDRAFT</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.constants</span> <span class="kn">import</span> <span class="n">scale_units</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.general_methods</span> <span class="kn">import</span> <span class="n">pyaedt_function_handler</span>


<div class="viewcode-block" id="GeometryOperators"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.html#pyaedt.modeler.geometry_operators.GeometryOperators">[docs]</a><span class="k">class</span> <span class="nc">GeometryOperators</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages geometry operators.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="GeometryOperators.List2list"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.List2list.html#pyaedt.modeler.geometry_operators.GeometryOperators.List2list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">List2list</span><span class="p">(</span><span class="n">input_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a C# list object to a Python list.</span>

<span class="sd">        This function performs a deep conversion.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_list : List</span>
<span class="sd">            C# list to convert to a Python list.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            Converted Python list.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;List&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)):</span>
                <span class="n">output_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">List2list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_list</span></div>

<div class="viewcode-block" id="GeometryOperators.parse_dim_arg"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.parse_dim_arg.html#pyaedt.modeler.geometry_operators.GeometryOperators.parse_dim_arg">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">parse_dim_arg</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">scale_to_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variable_manager</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a number and unit to a float.</span>
<span class="sd">        Angles are converted in radians.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        string : str</span>
<span class="sd">            String to convert. For example, ``&quot;2mm&quot;``.</span>
<span class="sd">        scale_to_unit : str</span>
<span class="sd">            Units for the value to convert. For example, ``&quot;mm&quot;``.</span>
<span class="sd">        variable_manager : :class:`pyaedt.application.Variables.VariableManager`, optional</span>
<span class="sd">            Try to parse formula and returns numeric value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Value for the converted value and units. For example, ``0.002``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Parse `&#39;&quot;2mm&quot;&#39;`.</span>

<span class="sd">        &gt;&gt;&gt; from pyaedt.modeler.geometry_operators import GeometryOperators as go</span>
<span class="sd">        &gt;&gt;&gt; go.parse_dim_arg(&#39;2mm&#39;)</span>
<span class="sd">        &gt;&gt;&gt; 0.002</span>

<span class="sd">        Use the optional argument ``scale_to_unit`` to specify the destination unit.</span>

<span class="sd">        &gt;&gt;&gt; go.parse_dim_arg(&#39;2mm&#39;, scale_to_unit=&#39;mm&#39;)</span>
<span class="sd">        &gt;&gt;&gt; 2.0</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input argument is not string nor number&quot;</span><span class="p">)</span>
        <span class="n">sunit</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">scale_to_unit</span><span class="p">:</span>
            <span class="n">sunit</span> <span class="o">=</span> <span class="n">scale_units</span><span class="p">(</span><span class="n">scale_to_unit</span><span class="p">)</span>

        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(?P&lt;number&gt;[-+]?(\d+(\.\d*)?|\.\d+)([eE][-+]?\d+)?)\s*(?P&lt;unit&gt;[a-z_A-Z]*)&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="n">string</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">variable_manager</span><span class="p">:</span>
                    <span class="n">variable_manager</span><span class="p">[</span><span class="s2">&quot;temp_var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">string</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">variable_manager</span><span class="p">[</span><span class="s2">&quot;temp_var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">numeric_value</span>
                    <span class="k">del</span> <span class="n">variable_manager</span><span class="p">[</span><span class="s2">&quot;temp_var&quot;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">string</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">scale_units</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">))</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">))</span> <span class="o">*</span> <span class="n">scaling_factor</span> <span class="o">/</span> <span class="n">sunit</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">variable_manager</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">variable_manager</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s2">&quot;temp_var&quot;</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">variable_manager</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s2">&quot;temp_var&quot;</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">postprocessing</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">string</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">variable_manager</span><span class="p">[</span><span class="s2">&quot;temp_var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">sunit</span>
                <span class="k">del</span> <span class="n">variable_manager</span><span class="p">[</span><span class="s2">&quot;temp_var&quot;</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="GeometryOperators.cs_plane_to_axis_str"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.cs_plane_to_axis_str.html#pyaedt.modeler.geometry_operators.GeometryOperators.cs_plane_to_axis_str">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">cs_plane_to_axis_str</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a string for a coordinate system plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val :</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">           String for the coordinate system plane.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">PLANE</span><span class="o">.</span><span class="n">XY</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;XY&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Z&quot;</span>
        <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="n">PLANE</span><span class="o">.</span><span class="n">YZ</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;YZ&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;X&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Y&quot;</span></div>

<div class="viewcode-block" id="GeometryOperators.cs_plane_to_plane_str"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.cs_plane_to_plane_str.html#pyaedt.modeler.geometry_operators.GeometryOperators.cs_plane_to_plane_str">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">cs_plane_to_plane_str</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a string for a coordinate system plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val :</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">           String for the coordinate system plane.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">PLANE</span><span class="o">.</span><span class="n">XY</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;XY&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;XY&quot;</span>
        <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="n">PLANE</span><span class="o">.</span><span class="n">YZ</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;YZ&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;YZ&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;ZX&quot;</span></div>

<div class="viewcode-block" id="GeometryOperators.cs_axis_str"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.cs_axis_str.html#pyaedt.modeler.geometry_operators.GeometryOperators.cs_axis_str">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">cs_axis_str</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a string for a coordinate system axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val :</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            String for the coordinate system axis.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">AXIS</span><span class="o">.</span><span class="n">X</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;X&quot;</span>
        <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="n">AXIS</span><span class="o">.</span><span class="n">Y</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Y&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Z&quot;</span></div>

<div class="viewcode-block" id="GeometryOperators.draft_type_str"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.draft_type_str.html#pyaedt.modeler.geometry_operators.GeometryOperators.draft_type_str">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">draft_type_str</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the draft type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val :</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">           Type of the draft.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">SWEEPDRAFT</span><span class="o">.</span><span class="n">Extended</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Extended&quot;</span>
        <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="n">SWEEPDRAFT</span><span class="o">.</span><span class="n">Round</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Round&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Natural&quot;</span></div>

<div class="viewcode-block" id="GeometryOperators.get_mid_point"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.get_mid_point.html#pyaedt.modeler.geometry_operators.GeometryOperators.get_mid_point">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_mid_point</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the midpoint between two points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point.</span>
<span class="sd">        v2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the midpoint.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">[((</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">m</span></div>

<div class="viewcode-block" id="GeometryOperators.get_triangle_area"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.get_triangle_area.html#pyaedt.modeler.geometry_operators.GeometryOperators.get_triangle_area">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_triangle_area</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the area of a triangle defined by its three vertices.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vertex.</span>
<span class="sd">        v2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vertex.</span>
<span class="sd">        v3 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the third vertex.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Area of the triangle.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">((</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">v2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">((</span><span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">v1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">c</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="nb">complex</span><span class="p">):</span>
            <span class="n">area</span> <span class="o">=</span> <span class="n">area</span><span class="o">.</span><span class="n">real</span>
        <span class="k">return</span> <span class="n">area</span></div>

<div class="viewcode-block" id="GeometryOperators.v_cross"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_cross.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_cross">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the cross product of two geometry vectors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the result vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">c</span></div>

    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_v_dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the dot product between two geometry vectors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Result of the dot product.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">c</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">c</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="GeometryOperators.v_dot"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_dot.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_dot">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the dot product between two geometry vectors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Result of the dot product.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">_v_dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.v_prod"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_prod.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_prod">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_prod</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the product between a scalar value and a vector.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : float</span>
<span class="sd">            Scalar value.</span>
<span class="sd">        v : List</span>
<span class="sd">            List of values for the vector in the format ``[v1, v2,..., vn]``.</span>
<span class="sd">            The vector can be any length.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of values for the result vector. This list is the</span>
<span class="sd">            same length as the list for the input vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="GeometryOperators.v_rotate_about_axis"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_rotate_about_axis.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_rotate_about_axis">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_rotate_about_axis</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">radians</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate rotation of a vector around an axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vector : list</span>
<span class="sd">            List of the three component of the vector.</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle by which the vector is to be rotated (radians or degree).</span>
<span class="sd">        radians : bool, optional</span>
<span class="sd">            Whether the angle is expressed in radians. Default is ``False``.</span>
<span class="sd">        axis : str, optional</span>
<span class="sd">            Axis about which to rotate the vector. Default is ``&quot;z&quot;``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List of values for the result vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">radians</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">vector</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
            <span class="n">rotated_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">rotated_y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">rotated_z</span> <span class="o">=</span> <span class="n">z</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">rotated_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">rotated_y</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">rotated_z</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">rotated_x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">rotated_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">rotated_z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid axis. Choose &#39;x&#39;, &#39;y&#39;, or &#39;z&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rotated_x</span><span class="p">,</span> <span class="n">rotated_y</span><span class="p">,</span> <span class="n">rotated_z</span></div>

<div class="viewcode-block" id="GeometryOperators.v_sub"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_sub.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_sub">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_sub</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate two geometry vectors by subtracting them (a-b).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the result vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">c</span></div>

<div class="viewcode-block" id="GeometryOperators.v_sum"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_sum.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_sum">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate two geometry vectors by adding them (a+b).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the result vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">c</span></div>

<div class="viewcode-block" id="GeometryOperators.v_norm"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_norm.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_norm">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_norm</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the Euclidean norm of a geometry vector.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">         a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Evaluated norm in the same unit as the coordinates for the input vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">t</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">return</span> <span class="n">m</span></div>

<div class="viewcode-block" id="GeometryOperators.normalize_vector"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.normalize_vector.html#pyaedt.modeler.geometry_operators.GeometryOperators.normalize_vector">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">normalize_vector</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Normalize a geometry vector.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the normalized vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># normalize a vector to its norm</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="n">norm</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">vn</span></div>

<div class="viewcode-block" id="GeometryOperators.v_points"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_points.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_points">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_points</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Vector from one point to another point.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p1 : List</span>
<span class="sd">            Coordinates ``[x1,y1,z1]`` for the first point.</span>
<span class="sd">        p2 : List</span>
<span class="sd">            Coordinates ``[x2,y2,z2]`` for second point.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            Coordinates ``[vx, vy, vz]`` for the vector from the first point to the second point.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.points_distance"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.points_distance.html#pyaedt.modeler.geometry_operators.GeometryOperators.points_distance">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">points_distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the distance between two points expressed as their Cartesian coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p1 : List</span>
<span class="sd">            List of ``[x1,y1,z1]`` coordinates for the first point.</span>
<span class="sd">        p2 : List</span>
<span class="sd">            List of ``[x2,y2,z2]`` coordinates for the second ppint.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Distance between the two points in the same unit as the coordinates for the points.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># fmt: off</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>
        <span class="c1"># fmt: on</span>

<div class="viewcode-block" id="GeometryOperators.find_point_on_plane"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.find_point_on_plane.html#pyaedt.modeler.geometry_operators.GeometryOperators.find_point_on_plane">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_point_on_plane</span><span class="p">(</span><span class="n">pointlists</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find a point on a plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pointlists : List</span>
<span class="sd">            List of points.</span>
<span class="sd">        direction : int, optional</span>
<span class="sd">             The default is ``0``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">direction</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">point</span> <span class="o">=</span> <span class="mf">1e6</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pointlists</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">point</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">point</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e6</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pointlists</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="n">direction</span> <span class="o">-</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">point</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">direction</span> <span class="o">-</span> <span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">point</span></div>

<div class="viewcode-block" id="GeometryOperators.distance_vector"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.distance_vector.html#pyaedt.modeler.geometry_operators.GeometryOperators.distance_vector">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">distance_vector</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the vector distance between point ``p`` and a line defined by two points, ``a`` and ``b``.</span>

<span class="sd">        .. note::</span>
<span class="sd">            he formula is  ``d = (a-p)-((a-p)dot p)n``, where ``a`` is a point of the line (either ``a`` or ``b``)</span>
<span class="sd">            and ``n`` is the unit vector in the direction of the line.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the reference point.</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the segment.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the segment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the distance vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v1</span><span class="p">]</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">_v_dot</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">v3</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">s1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">n</span><span class="p">]</span>
        <span class="n">vd</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vd</span></div>

<div class="viewcode-block" id="GeometryOperators.is_between_points"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_between_points.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_between_points">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_between_points</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a point lies on the segment defined by two points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the reference point ``p``.</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the segment.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the segment.</span>
<span class="sd">        tol : float</span>
<span class="sd">            Linear tolerance. The default value is ``1e-6``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when the point lies on the segment defined by the two points, ``False`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_cross</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)))</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># not collinear</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">_v_dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">_v_dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">t1</span> <span class="o">&gt;</span> <span class="n">t2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="GeometryOperators.is_parallel"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_parallel.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_parallel">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_parallel</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a segment defined by two points is parallel to a segment defined by two other points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the fiirst segment.</span>
<span class="sd">        a2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the first segment.</span>
<span class="sd">        b1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the second segment.</span>
<span class="sd">        b2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the second segment.</span>
<span class="sd">        tol : float</span>
<span class="sd">            Linear tolerance. The default value is ``1e-6``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">parallel_coeff</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="o">*</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GeometryOperators.parallel_coeff"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.parallel_coeff.html#pyaedt.modeler.geometry_operators.GeometryOperators.parallel_coeff">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">parallel_coeff</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ADD DESCRIPTION.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the first segment.</span>
<span class="sd">        a2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the first segment.</span>
<span class="sd">        b1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the second segment.</span>
<span class="sd">        b2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the second segment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            _vdot of 4 vertices of 2 segments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">va</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
        <span class="n">vb</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
        <span class="n">an</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">va</span><span class="p">)</span>
        <span class="n">bn</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">vb</span><span class="p">)</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">_v_dot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">an</span> <span class="o">*</span> <span class="n">bn</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.is_collinear"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_collinear.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_collinear">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two vectors are collinear (parallel or anti-parallel).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>
<span class="sd">        tol : float</span>
<span class="sd">            Linear tolerance. The default value is ``1e-6``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` if vectors are collinear, ``False`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">an</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">bn</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">_v_dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">an</span> <span class="o">*</span> <span class="n">bn</span><span class="p">)</span>
        <span class="k">if</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="o">*</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GeometryOperators.is_projection_inside"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_projection_inside.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_projection_inside">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_projection_inside</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Project a segment onto another segment and check if the projected segment is inside it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the projected segment.</span>
<span class="sd">        a2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the projected segment.</span>
<span class="sd">        b1 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the other segment.</span>
<span class="sd">        b2 : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the other segment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when the projected segment is inside the other segmennt, ``False`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_parallel</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">distance_vector</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
        <span class="n">a1n</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sum</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">a2n</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sum</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_between_points</span><span class="p">(</span><span class="n">a1n</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_between_points</span><span class="p">(</span><span class="n">a2n</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="GeometryOperators.arrays_positions_sum"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.arrays_positions_sum.html#pyaedt.modeler.geometry_operators.GeometryOperators.arrays_positions_sum">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">arrays_positions_sum</span><span class="p">(</span><span class="n">vertlist1</span><span class="p">,</span> <span class="n">vertlist2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ADD DESCRIPTION.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vertlist1 : List</span>

<span class="sd">        vertlist2 : List</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">vertlist1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">el1</span> <span class="ow">in</span> <span class="n">vertlist2</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">points_distance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">el1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vertlist1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertlist2</span><span class="p">))</span></div>

<div class="viewcode-block" id="GeometryOperators.v_angle"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_angle.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_angle">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the angle between two geometry vectors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Angle in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">an</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">bn</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">an</span> <span class="o">*</span> <span class="n">bn</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="p">(</span><span class="n">an</span> <span class="o">*</span> <span class="n">bn</span><span class="p">))</span></div>

<div class="viewcode-block" id="GeometryOperators.pointing_to_axis"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.pointing_to_axis.html#pyaedt.modeler.geometry_operators.GeometryOperators.pointing_to_axis">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">pointing_to_axis</span><span class="p">(</span><span class="n">x_pointing</span><span class="p">,</span> <span class="n">y_pointing</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the axes from the HFSS X axis and Y pointing axis as per</span>
<span class="sd">        the definition of the AEDT interface coordinate system.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x_pointing : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the X axis.</span>

<span class="sd">        y_pointing : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the Y pointing axis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            ``[Xx, Xy, Xz], [Yx, Yy, Yz], [Zx, Zy, Zz]`` of the three axes (normalized).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">zpt</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_cross</span><span class="p">(</span><span class="n">x_pointing</span><span class="p">,</span> <span class="n">y_pointing</span><span class="p">)</span>
        <span class="n">ypt</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_cross</span><span class="p">(</span><span class="n">zpt</span><span class="p">,</span> <span class="n">x_pointing</span><span class="p">)</span>

        <span class="n">xp</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">(</span><span class="n">x_pointing</span><span class="p">)</span>
        <span class="n">zp</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">(</span><span class="n">zpt</span><span class="p">)</span>
        <span class="n">yp</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">(</span><span class="n">ypt</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">zp</span></div>

<div class="viewcode-block" id="GeometryOperators.axis_to_euler_zxz"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.axis_to_euler_zxz.html#pyaedt.modeler.geometry_operators.GeometryOperators.axis_to_euler_zxz">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">axis_to_euler_zxz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve Euler angles of a frame following the rotation sequence ZXZ.</span>

<span class="sd">        Provides assumption for the gimbal lock problem.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : List</span>
<span class="sd">            List of ``[Xx, Xy, Xz]`` coordinates for the X axis.</span>
<span class="sd">        y : List</span>
<span class="sd">            List of ``[Yx, Yy, Yz]`` coordinates for the Y axis.</span>
<span class="sd">        z : List</span>
<span class="sd">            List of ``[Zx, Zy, Zz]`` coordinates for the Z axis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            (phi, theta, psi) containing the Euler angles in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-16</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">y3</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z3</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="o">-</span><span class="n">z2</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">psi</span></div>

<div class="viewcode-block" id="GeometryOperators.axis_to_euler_zyz"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.axis_to_euler_zyz.html#pyaedt.modeler.geometry_operators.GeometryOperators.axis_to_euler_zyz">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">axis_to_euler_zyz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve Euler angles of a frame following the rotation sequence ZYZ.</span>

<span class="sd">        Provides assumption for the gimbal lock problem.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : List</span>
<span class="sd">            List of ``[Xx, Xy, Xz]`` coordinates for the X axis.</span>
<span class="sd">        y : List</span>
<span class="sd">            List of ``[Yx, Yy, Yz]`` coordinates for the Y axis.</span>
<span class="sd">        z : List</span>
<span class="sd">            List of ``[Zx, Zy, Zz]`` coordinates for the Z axis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            (phi, theta, psi) containing the Euler angles in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-16</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">y3</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z3</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span> <span class="n">z1</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span> <span class="o">-</span><span class="n">x3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">psi</span></div>

<div class="viewcode-block" id="GeometryOperators.quaternion_to_axis"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_axis.html#pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_axis">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">quaternion_to_axis</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a quaternion to a rotated frame defined by X, Y, and Z axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            [Xx, Xy, Xz], [Yx, Yy, Yz], [Zx, Zy, Zz] of the three axes (normalized).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">q4</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

        <span class="n">m11</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q1</span> <span class="o">+</span> <span class="n">q2</span> <span class="o">*</span> <span class="n">q2</span> <span class="o">-</span> <span class="n">q3</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q4</span> <span class="o">*</span> <span class="n">q4</span>
        <span class="n">m12</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q4</span><span class="p">)</span>
        <span class="n">m13</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q3</span><span class="p">)</span>

        <span class="n">m21</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q4</span><span class="p">)</span>
        <span class="n">m22</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q1</span> <span class="o">-</span> <span class="n">q2</span> <span class="o">*</span> <span class="n">q2</span> <span class="o">+</span> <span class="n">q3</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q4</span> <span class="o">*</span> <span class="n">q4</span>
        <span class="n">m23</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q3</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">-</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="p">)</span>

        <span class="n">m31</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">-</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q3</span><span class="p">)</span>
        <span class="n">m32</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q3</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="p">)</span>
        <span class="n">m33</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q1</span> <span class="o">-</span> <span class="n">q2</span> <span class="o">*</span> <span class="n">q2</span> <span class="o">-</span> <span class="n">q3</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q4</span> <span class="o">*</span> <span class="n">q4</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">([</span><span class="n">m11</span><span class="p">,</span> <span class="n">m21</span><span class="p">,</span> <span class="n">m31</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">([</span><span class="n">m12</span><span class="p">,</span> <span class="n">m22</span><span class="p">,</span> <span class="n">m32</span><span class="p">])</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">([</span><span class="n">m13</span><span class="p">,</span> <span class="n">m23</span><span class="p">,</span> <span class="n">m33</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span></div>

<div class="viewcode-block" id="GeometryOperators.quaternion_to_axis_angle"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_axis_angle.html#pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_axis_angle">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">quaternion_to_axis_angle</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a quaternion to the axis angle rotation formulation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            ([ux, uy, uz], theta) containing the rotation axes expressed as X, Y, Z components of</span>
<span class="sd">            the unit vector ``u`` and the rotation angle theta expressed in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">q4</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q2</span> <span class="o">+</span> <span class="n">q3</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q4</span> <span class="o">*</span> <span class="n">q4</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">u</span> <span class="o">=</span> <span class="p">[</span><span class="n">q2</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">q3</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">q4</span> <span class="o">/</span> <span class="n">n</span><span class="p">]</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">theta</span></div>

<div class="viewcode-block" id="GeometryOperators.axis_angle_to_quaternion"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.axis_angle_to_quaternion.html#pyaedt.modeler.geometry_operators.GeometryOperators.axis_angle_to_quaternion">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">axis_angle_to_quaternion</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the axis angle rotation formulation to a quaternion.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        u : List</span>
<span class="sd">            List of ``[ux, uy, uz]`` coordinates for the rotation axis.</span>

<span class="sd">        theta : float</span>
<span class="sd">            Angle of rotation in radians.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">un</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">un</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">s</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">un</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">s</span>
        <span class="n">q4</span> <span class="o">=</span> <span class="n">un</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">s</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">q4</span><span class="p">]</span></div>

<div class="viewcode-block" id="GeometryOperators.quaternion_to_euler_zxz"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_euler_zxz.html#pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_euler_zxz">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">quaternion_to_euler_zxz</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a quaternion to Euler angles following rotation sequence ZXZ.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            (phi, theta, psi) containing the Euler angles in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">q4</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">m13</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q3</span><span class="p">)</span>
        <span class="n">m23</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q3</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">-</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="p">)</span>
        <span class="n">m33</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q1</span> <span class="o">-</span> <span class="n">q2</span> <span class="o">*</span> <span class="n">q2</span> <span class="o">-</span> <span class="n">q3</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q4</span> <span class="o">*</span> <span class="n">q4</span>
        <span class="n">m31</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">-</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q3</span><span class="p">)</span>
        <span class="n">m32</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q3</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">m13</span><span class="p">,</span> <span class="o">-</span><span class="n">m23</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">m33</span> <span class="o">*</span> <span class="n">m33</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">m33</span><span class="p">)</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">m31</span><span class="p">,</span> <span class="n">m32</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">psi</span></div>

<div class="viewcode-block" id="GeometryOperators.euler_zxz_to_quaternion"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.euler_zxz_to_quaternion.html#pyaedt.modeler.geometry_operators.GeometryOperators.euler_zxz_to_quaternion">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">euler_zxz_to_quaternion</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">psi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the Euler angles following rotation sequence ZXZ to a quaternion.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phi : float</span>
<span class="sd">            Euler angle psi in radians.</span>
<span class="sd">        theta : float</span>
<span class="sd">            Euler angle theta in radians.</span>
<span class="sd">        psi : float</span>
<span class="sd">            Euler angle phi in radians.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">phi</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="n">psi</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q4</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">q4</span><span class="p">]</span></div>

<div class="viewcode-block" id="GeometryOperators.quaternion_to_euler_zyz"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_euler_zyz.html#pyaedt.modeler.geometry_operators.GeometryOperators.quaternion_to_euler_zyz">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">quaternion_to_euler_zyz</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a quaternion to Euler angles following rotation sequence ZYZ.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            (phi, theta, psi) containing the Euler angles in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">q4</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">m13</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q3</span><span class="p">)</span>
        <span class="n">m23</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q3</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">-</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="p">)</span>
        <span class="n">m33</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q1</span> <span class="o">-</span> <span class="n">q2</span> <span class="o">*</span> <span class="n">q2</span> <span class="o">-</span> <span class="n">q3</span> <span class="o">*</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q4</span> <span class="o">*</span> <span class="n">q4</span>
        <span class="n">m31</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">-</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q3</span><span class="p">)</span>
        <span class="n">m32</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">q3</span> <span class="o">*</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">m23</span><span class="p">,</span> <span class="n">m13</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">m33</span> <span class="o">*</span> <span class="n">m33</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">m33</span><span class="p">)</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">m32</span><span class="p">,</span> <span class="o">-</span><span class="n">m31</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">psi</span></div>

<div class="viewcode-block" id="GeometryOperators.euler_zyz_to_quaternion"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.euler_zyz_to_quaternion.html#pyaedt.modeler.geometry_operators.GeometryOperators.euler_zyz_to_quaternion">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">euler_zyz_to_quaternion</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">psi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the Euler angles following rotation sequence ZYZ to a quaternion.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phi : float</span>
<span class="sd">            Euler angle psi in radians.</span>
<span class="sd">        theta : float</span>
<span class="sd">            Euler angle theta in radians.</span>
<span class="sd">        psi : float</span>
<span class="sd">            Euler angle phi in radians.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">phi</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="n">psi</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">q4</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">q4</span><span class="p">]</span></div>

<div class="viewcode-block" id="GeometryOperators.deg2rad"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.deg2rad.html#pyaedt.modeler.geometry_operators.GeometryOperators.deg2rad">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the angle from degrees to radians.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle in degrees.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Angle in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">return</span> <span class="n">angle</span> <span class="o">/</span> <span class="mf">180.0</span> <span class="o">*</span> <span class="n">pi</span></div>

<div class="viewcode-block" id="GeometryOperators.rad2deg"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.rad2deg.html#pyaedt.modeler.geometry_operators.GeometryOperators.rad2deg">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">rad2deg</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the angle from radians to degrees.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle in radians.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Angle in degrees.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">return</span> <span class="n">angle</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span></div>

<div class="viewcode-block" id="GeometryOperators.atan2"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.atan2.html#pyaedt.modeler.geometry_operators.GeometryOperators.atan2">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of atan2 that does not suffer from the following issues:</span>
<span class="sd">        math.atan2(0.0, 0.0) = 0.0</span>
<span class="sd">        math.atan2(-0.0, 0.0) = -0.0</span>
<span class="sd">        math.atan2(0.0, -0.0) = 3.141592653589793</span>
<span class="sd">        math.atan2(-0.0, -0.0) = -3.141592653589793</span>
<span class="sd">        and returns always 0.0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y : float</span>
<span class="sd">            Y-axis value for atan2.</span>

<span class="sd">        x : float</span>
<span class="sd">            X-axis value for atan2.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="mf">7.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.q_prod"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.q_prod.html#pyaedt.modeler.geometry_operators.GeometryOperators.q_prod">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">q_prod</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the product of two quaternions, ``p`` and ``q``, defined as:</span>
<span class="sd">        p = p0 + p&#39; = p0 + ip1 + jp2 + kp3.</span>
<span class="sd">        q = q0 + q&#39; = q0 + iq1 + jq2 + kq3.</span>
<span class="sd">        r = pq = p0q0 - p&#39; • q&#39; + p0q&#39; + q0p&#39; + p&#39; x q&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : List</span>
<span class="sd">            List of ``[p1, p2, p3, p4]`` coordinates for quaternion ``p``.</span>

<span class="sd">        q : List</span>
<span class="sd">            List of ``[p1, p2, p3, p4]`` coordinates for quaternion ``q``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of [r1, r2, r3, r4] coordinates for the result quaternion.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pv</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">qv</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

        <span class="n">r0</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="n">q0</span> <span class="o">-</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">pv</span><span class="p">,</span> <span class="n">qv</span><span class="p">)</span>

        <span class="n">t1</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_prod</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">qv</span><span class="p">)</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_prod</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">pv</span><span class="p">)</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_cross</span><span class="p">(</span><span class="n">pv</span><span class="p">,</span> <span class="n">qv</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sum</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rv</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span></div>

<div class="viewcode-block" id="GeometryOperators.q_rotation"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.q_rotation.html#pyaedt.modeler.geometry_operators.GeometryOperators.q_rotation">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">q_rotation</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the rotation of a vector, defined by a quaternion.</span>
<span class="sd">        Evaluated as:</span>
<span class="sd">        ``&quot;q = q0 + q&#39; = q0 + iq1 + jq2 + kq3&quot;``,</span>
<span class="sd">        ``&quot;w = qvq* = (q0^2 - |q&#39;|^2)v + 2(q&#39; • v)q&#39; + 2q0(q&#39; x v)&quot;``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : List</span>
<span class="sd">            List of ``[v1, v2, v3]`` coordinates for the vector.</span>
<span class="sd">        q : List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[w1, w2, w3]`` coordinates for the result vector ``w``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">qv</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

        <span class="n">c1</span> <span class="o">=</span> <span class="n">q0</span> <span class="o">*</span> <span class="n">q0</span> <span class="o">-</span> <span class="p">(</span><span class="n">qv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">qv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">qv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">qv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">qv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">qv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_prod</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="n">c2</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_prod</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">qv</span><span class="p">)</span>

        <span class="n">t3</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_cross</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">t4</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_prod</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sum</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">t4</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">w</span></div>

<div class="viewcode-block" id="GeometryOperators.q_rotation_inv"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.q_rotation_inv.html#pyaedt.modeler.geometry_operators.GeometryOperators.q_rotation_inv">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">q_rotation_inv</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the inverse rotation of a vector that is defined by a quaternion.</span>

<span class="sd">        It can also be the rotation of the coordinate frame with respect to the vector.</span>

<span class="sd">            q = q0 + q&#39; = q0 + iq1 + jq2 + kq3</span>
<span class="sd">            q* = q0 - q&#39; = q0 - iq1 - jq2 - kq3</span>
<span class="sd">            w = q*vq</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : List</span>
<span class="sd">            List of ``[v1, v2, v3]`` coordinates for the vector.</span>

<span class="sd">        q : List</span>
<span class="sd">            List of ``[q1, q2, q3, q4]`` coordinates for the quaternion.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of ``[w1, w2, w3]`` coordinates for the vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">q_rotation</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.get_polygon_centroid"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.get_polygon_centroid.html#pyaedt.modeler.geometry_operators.GeometryOperators.get_polygon_centroid">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_polygon_centroid</span><span class="p">(</span><span class="n">pts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the centroid of a polygon defined by its points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pts : List</span>
<span class="sd">            List of points, with each point defined by its ``[x,y,z]`` coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of [x,y,z] coordinates for the centroid of the polygon.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;pts must contain at list one point&quot;</span><span class="p">)</span>
        <span class="n">sx</span> <span class="o">=</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">sz</span> <span class="o">=</span> <span class="n">sl</span> <span class="o">=</span> <span class="n">sl2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)):</span>  <span class="c1"># counts from 0 to len(points)-1</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># in Python points[-1] is last element of points</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">L</span> <span class="o">=</span> <span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
            <span class="n">sx</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span>
            <span class="n">sy</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y0</span> <span class="o">+</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span>
            <span class="n">L2</span> <span class="o">=</span> <span class="p">((</span><span class="n">z1</span> <span class="o">-</span> <span class="n">z0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
            <span class="n">sz</span> <span class="o">+=</span> <span class="p">(</span><span class="n">z0</span> <span class="o">+</span> <span class="n">z1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L2</span>
            <span class="n">sl</span> <span class="o">+=</span> <span class="n">L</span>
            <span class="n">sl2</span> <span class="o">+=</span> <span class="n">L2</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="n">sx</span> <span class="o">/</span> <span class="n">sl</span> <span class="k">if</span> <span class="n">sl</span> <span class="o">!=</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="n">x1</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="n">sy</span> <span class="o">/</span> <span class="n">sl</span> <span class="k">if</span> <span class="n">sl</span> <span class="o">!=</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="n">y1</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="n">sz</span> <span class="o">/</span> <span class="n">sl2</span> <span class="k">if</span> <span class="n">sl2</span> <span class="o">!=</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="n">z1</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">]</span></div>

<div class="viewcode-block" id="GeometryOperators.cs_xy_pointing_expression"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.cs_xy_pointing_expression.html#pyaedt.modeler.geometry_operators.GeometryOperators.cs_xy_pointing_expression">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">cs_xy_pointing_expression</span><span class="p">(</span><span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">roll</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return x_pointing and y_pointing vectors as expressions from</span>
<span class="sd">        the yaw, ptich, and roll input (as strings).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        yaw : str, required</span>
<span class="sd">            String expression for the yaw angle (rotation about Z-axis)</span>
<span class="sd">        pitch : str</span>
<span class="sd">            String expression for the pitch angle (rotation about Y-axis)</span>
<span class="sd">        roll : str</span>
<span class="sd">            String expression for the roll angle (rotation about X-axis)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        [x_pointing, y_pointing] vector expressions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># X-Pointing</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="s2">&quot;cos(&quot;</span> <span class="o">+</span> <span class="n">yaw</span> <span class="o">+</span> <span class="s2">&quot;)*cos(&quot;</span> <span class="o">+</span> <span class="n">pitch</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="s2">&quot;sin(&quot;</span> <span class="o">+</span> <span class="n">yaw</span> <span class="o">+</span> <span class="s2">&quot;)*cos(&quot;</span> <span class="o">+</span> <span class="n">pitch</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="n">xz</span> <span class="o">=</span> <span class="s2">&quot;sin(&quot;</span> <span class="o">+</span> <span class="n">pitch</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

        <span class="c1"># Y-Pointing</span>
        <span class="n">yx</span> <span class="o">=</span> <span class="s2">&quot;sin(&quot;</span> <span class="o">+</span> <span class="n">roll</span> <span class="o">+</span> <span class="s2">&quot;)*sin(&quot;</span> <span class="o">+</span> <span class="n">pitch</span> <span class="o">+</span> <span class="s2">&quot;)*cos(&quot;</span> <span class="o">+</span> <span class="n">yaw</span> <span class="o">+</span> <span class="s2">&quot;) - &quot;</span>
        <span class="n">yx</span> <span class="o">+=</span> <span class="s2">&quot;sin(&quot;</span> <span class="o">+</span> <span class="n">yaw</span> <span class="o">+</span> <span class="s2">&quot;)*cos(&quot;</span> <span class="o">+</span> <span class="n">roll</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

        <span class="n">yy</span> <span class="o">=</span> <span class="s2">&quot;sin(&quot;</span> <span class="o">+</span> <span class="n">roll</span> <span class="o">+</span> <span class="s2">&quot;)*sin(&quot;</span> <span class="o">+</span> <span class="n">yaw</span> <span class="o">+</span> <span class="s2">&quot;)*sin(&quot;</span> <span class="o">+</span> <span class="n">pitch</span> <span class="o">+</span> <span class="s2">&quot;) + &quot;</span>
        <span class="n">yy</span> <span class="o">+=</span> <span class="s2">&quot;cos(&quot;</span> <span class="o">+</span> <span class="n">roll</span> <span class="o">+</span> <span class="s2">&quot;)*cos(&quot;</span> <span class="o">+</span> <span class="n">yaw</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

        <span class="n">yz</span> <span class="o">=</span> <span class="s2">&quot;sin(&quot;</span> <span class="o">+</span> <span class="n">roll</span> <span class="o">+</span> <span class="s2">&quot; + pi)*cos(&quot;</span> <span class="o">+</span> <span class="n">pitch</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>  <span class="c1"># use pi to avoid negative sign.</span>

        <span class="c1"># x, y pointing vectors for CS</span>
        <span class="n">x_pointing</span> <span class="o">=</span> <span class="p">[</span><span class="n">xx</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">xz</span><span class="p">]</span>
        <span class="n">y_pointing</span> <span class="o">=</span> <span class="p">[</span><span class="n">yx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">yz</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">x_pointing</span><span class="p">,</span> <span class="n">y_pointing</span><span class="p">]</span></div>

<div class="viewcode-block" id="GeometryOperators.get_numeric"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.get_numeric.html#pyaedt.modeler.geometry_operators.GeometryOperators.get_numeric">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_numeric</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a string to a numeric value. Discard the suffix.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;Global&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.is_small"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_small.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_small">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_small</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the number represented by s is zero (i.e very small).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s, numeric or str</span>
<span class="sd">            Variable value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">get_numeric</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GeometryOperators.numeric_cs"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.numeric_cs.html#pyaedt.modeler.geometry_operators.GeometryOperators.numeric_cs">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">numeric_cs</span><span class="p">(</span><span class="n">cs_in</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of [x,y,z] numeric values given a coordinate system as input.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cs_in : List of str or str</span>
<span class="sd">            ``[&quot;x&quot;, &quot;y&quot;, &quot;z&quot;]`` or &quot;Global&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cs_in</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cs_in</span> <span class="o">==</span> <span class="s2">&quot;Global&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cs_in</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cs_in</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">get_numeric</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="k">else</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cs_in</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="GeometryOperators.orient_polygon"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.orient_polygon.html#pyaedt.modeler.geometry_operators.GeometryOperators.orient_polygon">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">orient_polygon</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">clockwise</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Orient a polygon clockwise or counterclockwise. The vertices should be already ordered either way.</span>
<span class="sd">        Use this function to change the orientation.</span>
<span class="sd">        The polygon is represented by its vertices coordinates.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : List</span>
<span class="sd">            List of x coordinates of the vertices. Length must be &gt;= 1.</span>
<span class="sd">            Degenerate polygon with only 2 points is also accepted, in this case the points are returned unchanged.</span>
<span class="sd">        y : List</span>
<span class="sd">            List of y coordinates of the vertices. Must be of the same length as x.</span>
<span class="sd">        clockwise : bool</span>
<span class="sd">            If ``True`` the polygon is oriented clockwise, if ``False`` it is oriented counterclockwise.</span>
<span class="sd">            Default is ``True``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of List</span>
<span class="sd">            Lists of oriented vertices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_ret</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:]</span>
        <span class="n">y_ret</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;x&#39; length must be &gt;= 2&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;y&#39; must be same length as &#39;x&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_ret</span><span class="p">,</span> <span class="n">y_ret</span>
        <span class="c1"># fmt: off</span>
        <span class="c1"># select a vertex on the hull</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ixmin</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">xmin</span> <span class="o">==</span> <span class="n">el</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ixmin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">imin</span> <span class="o">=</span> <span class="n">ixmin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># searching for the minimum y</span>
            <span class="n">tmpy</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ixmin</span><span class="p">]</span>
            <span class="n">min_tmpy</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tmpy</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">imin</span> <span class="o">=</span> <span class="n">min_tmpy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">imin</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">imin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># the minimum is the first point of the polygon</span>
            <span class="n">xa</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ya</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">xb</span> <span class="o">=</span> <span class="n">xmin</span>
            <span class="n">yb</span> <span class="o">=</span> <span class="n">ymin</span>
            <span class="n">xc</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">yc</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">imin</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># the minimum is the last point of the polygon</span>
            <span class="n">xa</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">imin</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ya</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">imin</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">xb</span> <span class="o">=</span> <span class="n">xmin</span>
            <span class="n">yb</span> <span class="o">=</span> <span class="n">ymin</span>
            <span class="n">xc</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yc</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xa</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">imin</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ya</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">imin</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">xb</span> <span class="o">=</span> <span class="n">xmin</span>
            <span class="n">yb</span> <span class="o">=</span> <span class="n">ymin</span>
            <span class="n">xc</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">imin</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">yc</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">imin</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">det</span> <span class="o">=</span> <span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yc</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">xc</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">det</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># counterclockwise</span>
            <span class="n">is_CW</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c1"># clockwise</span>
            <span class="n">is_CW</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># fmt: on</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">clockwise</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_CW</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">clockwise</span> <span class="ow">and</span> <span class="n">is_CW</span><span class="p">):</span>
            <span class="n">x_ret</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">y_ret</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">x_ret</span><span class="p">,</span> <span class="n">y_ret</span></div>

<div class="viewcode-block" id="GeometryOperators.v_angle_sign"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_angle_sign.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_angle_sign">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_angle_sign</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">,</span> <span class="n">vn</span><span class="p">,</span> <span class="n">right_handed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the signed angle between two geometry vectors.</span>
<span class="sd">        The sign is evaluated respect to the normal to the plane containing the two vectors as per the following rule.</span>
<span class="sd">        In case of opposite vectors, it returns an angle equal to 180deg (always positive).</span>
<span class="sd">        Assuming that the plane normal is normalized (vb == 1), the signed angle is simplified.</span>
<span class="sd">        For the right-handed rotation from Va to Vb:</span>
<span class="sd">        - atan2((va x Vb) . vn, va . vb).</span>
<span class="sd">        For the left-handed rotation from Va to Vb:</span>
<span class="sd">        - atan2((Vb x va) . vn, va . vb).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        va : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        vb : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>
<span class="sd">        vn : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the plane normal.</span>
<span class="sd">        right_handed : bool</span>
<span class="sd">            Whether to consider the right-handed rotation from va to vb. The default is ``True``.</span>
<span class="sd">            When ``False``, left-hand rotation from va to vb is considered.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Angle in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>
        <span class="n">cross</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_cross</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">cross</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">assert</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_collinear</span><span class="p">(</span><span class="n">cross</span><span class="p">,</span> <span class="n">vn</span><span class="p">),</span> <span class="p">(</span>
            <span class="s2">&quot;vn must be the normal to the &quot;</span> <span class="s2">&quot;plane containing va and vb.&quot;</span>
        <span class="p">)</span>  <span class="c1"># pragma: no cover</span>

        <span class="n">vnn</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">normalize_vector</span><span class="p">(</span><span class="n">vn</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">right_handed</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">cross</span><span class="p">,</span> <span class="n">vnn</span><span class="p">),</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mcross</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_cross</span><span class="p">(</span><span class="n">vb</span><span class="p">,</span> <span class="n">va</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">mcross</span><span class="p">,</span> <span class="n">vnn</span><span class="p">),</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">))</span></div>

<div class="viewcode-block" id="GeometryOperators.v_angle_sign_2D"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.v_angle_sign_2D.html#pyaedt.modeler.geometry_operators.GeometryOperators.v_angle_sign_2D">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">v_angle_sign_2D</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">,</span> <span class="n">right_handed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the signed angle between two 2D geometry vectors.</span>
<span class="sd">        Iit the 2D version of the ``GeometryOperators.v_angle_sign`` considering vn = [0,0,1].</span>
<span class="sd">        In case of opposite vectors, it returns an angle equal to 180deg (always positive).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        va : List</span>
<span class="sd">            List of ``[x, y]`` coordinates for the first vector.</span>
<span class="sd">        vb : List</span>
<span class="sd">            List of ``[x, y]`` coordinates for the second vector.</span>
<span class="sd">        right_handed : bool</span>
<span class="sd">            Whether to consider the right-handed rotation from Va to Vb. The default is ``True``.</span>
<span class="sd">            When ``False``, left-hand rotation from Va to Vb is considered.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Angle in radians.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">va</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">vb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">va</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">vb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">right_handed</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_dot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">))</span></div>

<div class="viewcode-block" id="GeometryOperators.point_in_polygon"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.point_in_polygon.html#pyaedt.modeler.geometry_operators.GeometryOperators.point_in_polygon">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">point_in_polygon</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine if a point is inside or outside a polygon, both located on the same plane.</span>

<span class="sd">        The method implements the radial algorithm (https://es.wikipedia.org/wiki/Algoritmo_radial)</span>

<span class="sd">        point : List</span>
<span class="sd">            List of ``[x, y]`` coordinates.</span>
<span class="sd">        polygon : List</span>
<span class="sd">            [[x1, x2, ..., xn],[y1, y2, ..., yn]]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            - ``-1`` When the point is outside the polygon.</span>
<span class="sd">            - ``0`` When the point is exactly on one of the sides of the polygon.</span>
<span class="sd">            - ``1`` When the point is inside the polygon.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># fmt: off</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-8</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">point</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;point must be a list in the form [x, y]&quot;</span><span class="p">)</span>
        <span class="n">pl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="n">pl</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Polygon x and y lists must be the same length&quot;</span><span class="p">)</span>
        <span class="n">asum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pl</span><span class="p">):</span>
            <span class="n">vj</span> <span class="o">=</span> <span class="p">[</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">vi</span> <span class="o">=</span> <span class="p">[</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">points_distance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># point is one of polyline vertices</span>
            <span class="n">vpj</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">vj</span><span class="p">)</span>
            <span class="n">vpi</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_angle_sign_2D</span><span class="p">(</span><span class="n">vpj</span><span class="p">,</span> <span class="n">vpi</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="n">asum</span> <span class="o">+=</span> <span class="n">a</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">asum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">asum</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error!&quot;</span><span class="p">)</span></div>
        <span class="c1"># fmt: on</span>

<div class="viewcode-block" id="GeometryOperators.is_point_in_polygon"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_point_in_polygon.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_point_in_polygon">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_point_in_polygon</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine if a point is inside or outside a polygon, both located on the same plane.</span>

<span class="sd">        The method implements the radial algorithm (https://es.wikipedia.org/wiki/Algoritmo_radial)</span>

<span class="sd">        point : List</span>
<span class="sd">            List of ``[x, y]`` coordinates.</span>
<span class="sd">        polygon : List</span>
<span class="sd">            [[x1, x2, ..., xn],[y1, y2, ..., yn]]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` if the point is inside the polygon or exactly on one of its sides.</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">point_in_polygon</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="GeometryOperators.are_segments_intersecting"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.are_segments_intersecting.html#pyaedt.modeler.geometry_operators.GeometryOperators.are_segments_intersecting">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">are_segments_intersecting</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">include_collinear</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if the two segments a and b are intersecting.</span>

<span class="sd">        a1 : List</span>
<span class="sd">            First point of segment a. List of ``[x, y]`` coordinates.</span>
<span class="sd">        a2 : List</span>
<span class="sd">            Second point of segment a. List of ``[x, y]`` coordinates.</span>
<span class="sd">        b1 : List</span>
<span class="sd">            First point of segment b. List of ``[x, y]`` coordinates.</span>
<span class="sd">        b2 : List</span>
<span class="sd">            Second point of segment b. List of ``[x, y]`` coordinates.</span>
<span class="sd">        include_collinear : bool</span>
<span class="sd">            If ``True`` two segments are considered intersecting also if just one end lies on the other segment.</span>
<span class="sd">            Default is ``True``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` if the segments are intersecting.</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># fmt: off</span>
        <span class="k">def</span> <span class="nf">on_segment</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
            <span class="c1"># Given three collinear points p, q, r, the function checks if point q lies on line-segment &#39;pr&#39;</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="ow">and</span>
               <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">orientation</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
            <span class="c1"># Find the orientation of an ordered triplet (p,q,r) using the slope evaluation.</span>
            <span class="c1"># The function returns the following values:</span>
            <span class="c1"># 0 : Collinear points</span>
            <span class="c1"># 1 : Clockwise points</span>
            <span class="c1"># -1 : Counterclockwise</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># Clockwise orientation</span>
            <span class="k">elif</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Counterclockwise orientation</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>   <span class="c1"># Collinear orientation</span>

        <span class="c1"># MAIN</span>
        <span class="c1"># Find the 4 orientations</span>
        <span class="n">o1</span> <span class="o">=</span> <span class="n">orientation</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">)</span>
        <span class="n">o2</span> <span class="o">=</span> <span class="n">orientation</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">orientation</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="n">o4</span> <span class="o">=</span> <span class="n">orientation</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>

        <span class="c1"># General case</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">o1</span> <span class="o">!=</span> <span class="n">o2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">o3</span> <span class="o">!=</span> <span class="n">o4</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">include_collinear</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># a1 , a2 and b1 are collinear and b1 lies on segment a1a2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">o1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">a2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="c1"># a1 , a2 and b2 are collinear and b2 lies on segment a1a2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">o2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">a2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="c1"># b1 , b2 and a1 are collinear and a1 lies on segment b1b2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">o3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="c1"># b1 , b2 and a2 are collinear and a2 lies on segment b1b2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">o4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># Special Cases</span>
        <span class="c1"># a1 , a2 and b1 are collinear and b1 lies on segment a1a2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">o1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">a2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">include_collinear</span>
        <span class="c1"># a1 , a2 and b2 are collinear and b2 lies on segment a1a2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">o2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">a2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">include_collinear</span>
        <span class="c1"># b1 , b2 and a1 are collinear and a1 lies on segment b1b2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">o3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">include_collinear</span>
        <span class="c1"># b1 , b2 and a2 are collinear and a2 lies on segment b1b2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">o4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">include_collinear</span>
        <span class="c1"># If none of the cases</span>
        <span class="k">return</span> <span class="kc">False</span></div>
        <span class="c1"># fmt: on</span>

<div class="viewcode-block" id="GeometryOperators.is_segment_intersecting_polygon"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_segment_intersecting_polygon.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_segment_intersecting_polygon">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_segment_intersecting_polygon</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if a segment defined by two points ``a`` and ``b`` intersects a polygon.</span>
<span class="sd">        Points on the vertices and on the polygon boundaries are not considered intersecting.</span>

<span class="sd">        a : List</span>
<span class="sd">            First point of the segment. List of ``[x, y]`` coordinates.</span>
<span class="sd">        b : List</span>
<span class="sd">            Second point of the segment. List of ``[x, y]`` coordinates.</span>
<span class="sd">        polygon : List</span>
<span class="sd">            [[x1, x2, ..., xn],[y1, y2, ..., yn]]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            ``True`` if the segment intersect the polygon. ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;point must be a list in the form [x, y]&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;point must be a list in the form [x, y]&quot;</span>
        <span class="n">pl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">pl</span><span class="p">,</span> <span class="s2">&quot;Polygon x and y lists must be the same length&quot;</span>

        <span class="n">a_in</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_point_in_polygon</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">polygon</span><span class="p">)</span>
        <span class="n">b_in</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_point_in_polygon</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">polygon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a_in</span> <span class="o">!=</span> <span class="n">b_in</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># one point is inside and one is outside, no need for further investigation.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pl</span><span class="p">):</span>
            <span class="n">vj</span> <span class="o">=</span> <span class="p">[</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>
            <span class="n">vi</span> <span class="o">=</span> <span class="p">[</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">are_segments_intersecting</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">vj</span><span class="p">,</span> <span class="n">include_collinear</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GeometryOperators.is_perpendicular"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_perpendicular.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_perpendicular">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_perpendicular</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two vectors are perpendicular.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first vector.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second vector.</span>
<span class="sd">        tol : float</span>
<span class="sd">            Linear tolerance. The default value is ``1e-6``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` if vectors are perpendicular, ``False`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">_v_dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="o">*</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GeometryOperators.is_point_projection_in_segment"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.is_point_projection_in_segment.html#pyaedt.modeler.geometry_operators.GeometryOperators.is_point_projection_in_segment">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_point_projection_in_segment</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a point projection lies on the segment defined by two points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the reference point ``p``.</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the segment.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the segment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when the projection point lies on the segment defined by the two points, ``False`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># fmt: off</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">inner_product</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">dy</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">inner_product</span> <span class="o">&lt;=</span> <span class="n">dx</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span></div>
        <span class="c1"># fmt: on</span>

<div class="viewcode-block" id="GeometryOperators.point_segment_distance"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.point_segment_distance.html#pyaedt.modeler.geometry_operators.GeometryOperators.point_segment_distance">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">point_segment_distance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the distance between a point ``p`` and a segment defined by two points ``a`` and ``b``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the reference point ``p``.</span>
<span class="sd">        a : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the first point of the segment.</span>
<span class="sd">        b : List</span>
<span class="sd">            List of ``[x, y, z]`` coordinates for the second point of the segment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Distance between the point and the segment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># fmt: off</span>
        <span class="n">den</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">/</span><span class="n">den</span>
        <span class="k">return</span> <span class="n">d</span></div>
        <span class="c1"># fmt: on</span>

<div class="viewcode-block" id="GeometryOperators.find_largest_rectangle_inside_polygon"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.find_largest_rectangle_inside_polygon.html#pyaedt.modeler.geometry_operators.GeometryOperators.find_largest_rectangle_inside_polygon">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_largest_rectangle_inside_polygon</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">partition_max_order</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the largest area rectangles of arbitrary orientation in a polygon.</span>

<span class="sd">        Implements the algorithm described by Rubén Molano, et al.</span>
<span class="sd">        *&quot;Finding the largest area rectangle of arbitrary orientation in a closed contour&quot;*, published in</span>
<span class="sd">        *Applied Mathematics and Computation*.</span>
<span class="sd">        https://doi.org/10.1016/j.amc.2012.03.063.</span>
<span class="sd">        (https://www.sciencedirect.com/science/article/pii/S0096300312003207)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        polygon : List</span>
<span class="sd">            [[x1, x2, ..., xn],[y1, y2, ..., yn]]</span>
<span class="sd">        partition_max_order : float, optional</span>
<span class="sd">            Order of the lattice partition used to find the quasi-lattice polygon that approximates ``polygon``.</span>
<span class="sd">            Default is ``16``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of List</span>
<span class="sd">            List containing the rectangles points. Return all rectangles found.</span>
<span class="sd">            List is in the form: [[[x1, y1],[x2, y2],...],[[x1, y1],[x2, y2],...],...].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># fmt: off</span>
        <span class="k">def</span> <span class="nf">evaluate_partition_size</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">partition_max_order</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">polygon</span>
            <span class="n">max_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">max_size</span><span class="o">/</span><span class="n">partition_max_order</span>
            <span class="k">return</span> <span class="n">L</span>

        <span class="k">def</span> <span class="nf">build_s_ploygon_points</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span>

            <span class="c1"># build the lattice</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">))</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">ymin</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">))</span>

            <span class="c1"># get the lattice points S inside the polygon</span>
            <span class="n">Spoints</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">xi</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">+</span> <span class="n">L</span> <span class="o">*</span> <span class="n">i</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">yj</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">L</span> <span class="o">*</span> <span class="n">j</span>
                    <span class="k">if</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_point_in_polygon</span><span class="p">([</span><span class="n">xi</span><span class="p">,</span> <span class="n">yj</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]):</span>
                        <span class="n">Spoints</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">xi</span><span class="p">,</span> <span class="n">yj</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Spoints</span>

        <span class="k">def</span> <span class="nf">build_u_matrix</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
            <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="c1"># preallocate the matrix</span>
            <span class="n">Umatrix</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="p">:</span>
                        <span class="n">Umatrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_segment_intersecting_polygon</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">polygon</span><span class="p">):</span>
                            <span class="n">Umatrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">p</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">get_mid_point</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_point_in_polygon</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
                                <span class="n">Umatrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">Umatrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_points</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Umatrix</span>

        <span class="k">def</span> <span class="nf">inside</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">def</span> <span class="nf">compute_largest_rectangle</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
            <span class="n">max_area</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">rectangles</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">inside</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">inside</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">is_perpendicular</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]):</span>
                                <span class="n">ps</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sum</span><span class="p">(</span><span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_sub</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
                                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                                    <span class="k">break</span>
                                <span class="k">if</span> <span class="n">inside</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">inside</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
                                    <span class="n">area</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
                                    <span class="k">if</span> <span class="n">area</span> <span class="o">&gt;</span> <span class="n">max_area</span><span class="p">:</span>
                                        <span class="n">max_area</span> <span class="o">=</span> <span class="n">area</span>
                                        <span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                                        <span class="n">rectangles</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span><span class="p">]</span>
                                    <span class="k">elif</span> <span class="n">area</span> <span class="o">==</span> <span class="n">max_area</span><span class="p">:</span>
                                        <span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                                        <span class="n">rectangles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rectangles</span>

        <span class="n">L</span> <span class="o">=</span> <span class="n">evaluate_partition_size</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">partition_max_order</span><span class="o">=</span><span class="n">partition_max_order</span><span class="p">)</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">build_s_ploygon_points</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">build_u_matrix</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">polygon</span><span class="p">)</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">compute_largest_rectangle</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">R</span></div>
        <span class="c1"># fmt: on</span>

<div class="viewcode-block" id="GeometryOperators.degrees_over_rounded"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.degrees_over_rounded.html#pyaedt.modeler.geometry_operators.GeometryOperators.degrees_over_rounded">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">degrees_over_rounded</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">digits</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ceil of angle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle in radians which will be converted to degrees and will be over-rounded to the next &quot;digits&quot; decimal.</span>
<span class="sd">        digits : int</span>
<span class="sd">            Integer number which is the number of decimals.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.radians_over_rounded"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.radians_over_rounded.html#pyaedt.modeler.geometry_operators.GeometryOperators.radians_over_rounded">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">radians_over_rounded</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">digits</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Radian angle ceiling.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle in degrees which will be converted to radians and will be over-rounded to the  next &quot;digits&quot; decimal.</span>
<span class="sd">        digits : int</span>
<span class="sd">            Integer number which is the number of decimals.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.degrees_default_rounded"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.degrees_default_rounded.html#pyaedt.modeler.geometry_operators.GeometryOperators.degrees_default_rounded">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">degrees_default_rounded</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">digits</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert angle to degree with given digits rounding.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle in radians which will be converted to degrees and will be under-rounded to the next &quot;digits&quot; decimal.</span>
<span class="sd">        digits : int</span>
<span class="sd">            Integer number which is the number of decimals.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.radians_default_rounded"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.radians_default_rounded.html#pyaedt.modeler.geometry_operators.GeometryOperators.radians_default_rounded">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">radians_default_rounded</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">digits</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to radians with given round.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle in degrees which will be converted to radians and will be under-rounded to the next &quot;digits&quot; decimal.</span>
<span class="sd">        digits : int</span>
<span class="sd">            Integer number which is the number of decimals.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">digits</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryOperators.find_closest_points"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.find_closest_points.html#pyaedt.modeler.geometry_operators.GeometryOperators.find_closest_points">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_closest_points</span><span class="p">(</span><span class="n">points_list</span><span class="p">,</span> <span class="n">reference_point</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a list of points, finds the closest points to a reference point.</span>
<span class="sd">        It returns a list of points because more than one can be found.</span>
<span class="sd">        It works with 2D or 3D points. The tolerance used to evaluate the distance</span>
<span class="sd">        to the reference point can be specified.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        points_list : List of List</span>
<span class="sd">            List of points. The points can be defined in 2D or 3D space.</span>
<span class="sd">        reference_point : List</span>
<span class="sd">            The reference point. The point can be defined in 2D or 3D space (same as points_list).</span>
<span class="sd">        tol : float, optional</span>
<span class="sd">            The tolerance used to evaluate the distance. Default is ``1e-6``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of List</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># fmt: off</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;points_list must be a list of points&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;points must be defined in either 2D or 3D space.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference_point</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Points in points_list attribute and reference_point must have the same length.&quot;</span><span class="p">)</span>
        <span class="c1"># make copy of the input points</span>
        <span class="n">pl</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">points_list</span><span class="p">]</span>
        <span class="n">pr</span> <span class="o">=</span> <span class="n">reference_point</span><span class="p">[:]</span>
        <span class="c1"># find the closest points</span>
        <span class="n">dm</span> <span class="o">=</span> <span class="mf">1e12</span>
        <span class="n">close_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pl</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">points_distance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pr</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">dm</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="n">close_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">dm</span><span class="p">:</span>
                <span class="n">dm</span> <span class="o">=</span> <span class="n">d</span>
                <span class="n">close_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">close_points</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">close_points</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">return</span> <span class="kc">False</span></div>
        <span class="c1"># fmt: on</span>

<div class="viewcode-block" id="GeometryOperators.mirror_point"><a class="viewcode-back" href="../../../API/_autosummary/pyaedt.modeler.geometry_operators.GeometryOperators.mirror_point.html#pyaedt.modeler.geometry_operators.GeometryOperators.mirror_point">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@pyaedt_function_handler</span>
    <span class="k">def</span> <span class="nf">mirror_point</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">reference</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mirror point about a plane defining by a point on the plane and a normal point.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start : list</span>
<span class="sd">            Point to be mirrored</span>
<span class="sd">        reference : list</span>
<span class="sd">            The reference point. Point on the plane around which you want to mirror the object.</span>
<span class="sd">        vector : list</span>
<span class="sd">            Normalized vector used for the mirroring.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of the reflected point.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">reference</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        <span class="n">vector_norm</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">v_norm</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="p">[</span><span class="n">vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">vector_norm</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        <span class="n">dot_product</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">distance</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
        <span class="n">reflection</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">dot_product</span> <span class="o">*</span> <span class="n">vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">start</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">reflection</span></div></div>
</pre></div>

              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright (c) 2023 ANSYS, Inc. All rights reserved.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>